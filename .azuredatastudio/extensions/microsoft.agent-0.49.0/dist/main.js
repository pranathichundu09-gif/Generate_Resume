(()=>{"use strict";var e={403:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});var i,a,n,s,l,r,h=o(622),d=o(747),c=Object.prototype.toString;function u(e){return void 0!==e}function p(e){return"[object Number]"===c.call(e)}function m(e){return"[object String]"===c.call(e)}function g(e){return JSON.parse(d.readFileSync(e,"utf8"))}function b(e,t){return r&&(e="［"+e.replace(/[aouei]/g,"$&$&")+"］"),0===t.length?e:e.replace(/\{(\d+)\}/g,(function(e,o){var i=o[0],a=t[i],n=e;return"string"==typeof a?n=a:"number"!=typeof a&&"boolean"!=typeof a&&null!=a||(n=String(a)),n}))}function w(e){return function(t,o){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];return p(t)?t>=e.length?void console.error("Broken localize call found. Index out of bounds. Stacktrace is\n: "+new Error("").stack):b(e[t],i):m(o)?(console.warn("Message "+o+" didn't get externalized correctly."),b(o,i)):void console.error("Broken localize call found. Stacktrace is\n: "+new Error("").stack)}}function x(e,t){for(var o=[],i=2;i<arguments.length;i++)o[i-2]=arguments[i];return b(t,o)}function S(e,t){return s[e]=t,t}function T(e){try{return function(e){var t=g(h.join(e,"nls.metadata.json")),o=Object.create(null);for(var i in t){var a=t[i];o[i]=a.messages}return o}(e)}catch(e){return void console.log("Generating default bundle from meta data failed.",e)}}function y(e,t){var o;if(!0===l.languagePackSupport&&void 0!==l.cacheRoot&&void 0!==l.languagePackId&&void 0!==l.translationsConfigFile&&void 0!==l.translationsConfig)try{o=function(e,t){var o,i,a,n=h.join(l.cacheRoot,e.id+"-"+e.hash+".json"),s=!1,r=!1;try{return o=JSON.parse(d.readFileSync(n,{encoding:"utf8",flag:"r"})),i=n,a=new Date,d.utimes(i,a,a,(function(){})),o}catch(e){if("ENOENT"===e.code)r=!0;else{if(!(e instanceof SyntaxError))throw e;console.log("Syntax error parsing message bundle: "+e.message+"."),d.unlink(n,(function(e){e&&console.error("Deleting corrupted bundle "+n+" failed.")})),s=!0}}if(!(o=function(e,t){var o=l.translationsConfig[e.id];if(o){var i=g(o).contents,a=g(h.join(t,"nls.metadata.json")),n=Object.create(null);for(var s in a){var r=a[s],d=i[e.outDir+"/"+s];if(d){for(var c=[],u=0;u<r.keys.length;u++){var p=r.keys[u],b=d[m(p)?p:p.key];void 0===b&&(b=r.messages[u]),c.push(b)}n[s]=c}else n[s]=r.messages}return n}}(e,t))||s)return o;if(r)try{d.writeFileSync(n,JSON.stringify(o),{encoding:"utf8",flag:"wx"})}catch(e){if("EEXIST"===e.code)return o;throw e}return o}(e,t)}catch(e){console.log("Load or create bundle failed ",e)}if(!o){if(l.languagePackSupport)return T(t);var i=function(e){for(var t=l.language;t;){var o=h.join(e,"nls.bundle."+t+".json");if(d.existsSync(o))return o;var i=t.lastIndexOf("-");t=i>0?t.substring(0,i):void 0}if(void 0===t&&(o=h.join(e,"nls.bundle.json"),d.existsSync(o)))return o}(t);if(i)try{return g(i)}catch(e){console.log("Loading in the box message bundle failed.",e)}o=T(t)}return o}function B(e){if(!e)return x;var t=h.extname(e);if(t&&(e=e.substr(0,e.length-t.length)),l.messageFormat===i.both||l.messageFormat===i.bundle){var o=function(e){for(var t,o=h.dirname(e);t=h.join(o,"nls.metadata.header.json"),!d.existsSync(t);){var i=h.dirname(o);if(i===o){t=void 0;break}o=i}return t}(e);if(o){var a=h.dirname(o),n=s[a];if(void 0===n)try{var c=JSON.parse(d.readFileSync(o,"utf8"));try{var p=y(c,a);n=S(a,p?{header:c,nlsBundle:p}:null)}catch(e){console.error("Failed to load nls bundle",e),n=S(a,null)}}catch(e){console.error("Failed to read header file",e),n=S(a,null)}if(n){var m=e.substr(a.length+1).replace(/\\/g,"/"),b=n.nlsBundle[m];return void 0===b?(console.error("Messages for file "+e+" not found. See console for details."),function(){return"Messages not found."}):w(b)}}}if(l.messageFormat===i.both||l.messageFormat===i.file)try{var T=g(function(e){var t;if(l.cacheLanguageResolution&&t)t=t;else{if(r||!l.language)t=".nls.json";else for(var o=l.language;o;){var i=".nls."+o+".json";if(d.existsSync(e+i)){t=i;break}var a=o.lastIndexOf("-");a>0?o=o.substring(0,a):(t=".nls.json",o=null)}l.cacheLanguageResolution&&(t=t)}return e+t}(e));return Array.isArray(T)?w(T):u(T.messages)&&u(T.keys)?w(T.messages):(console.error("String bundle '"+e+"' uses an unsupported format."),function(){return"File bundle has unsupported format. See console for details"})}catch(e){"ENOENT"!==e.code&&console.error("Failed to load single file bundle",e)}return console.error("Failed to load message bundle for file "+e),function(){return"Failed to load message bundle. See console for details."}}!function(e){e.file="file",e.bundle="bundle",e.both="both"}(i=t.MessageFormat||(t.MessageFormat={})),function(e){e.standalone="standalone",e.languagePack="languagePack"}(a=t.BundleFormat||(t.BundleFormat={})),function(e){e.is=function(e){var t=e;return t&&u(t.key)&&u(t.comment)}}(n||(n={})),function(){if(l={locale:void 0,language:void 0,languagePackSupport:!1,cacheLanguageResolution:!0,messageFormat:i.bundle},m(process.env.VSCODE_NLS_CONFIG))try{var e=JSON.parse(process.env.VSCODE_NLS_CONFIG),t=void 0;if(e.availableLanguages){var o=e.availableLanguages["*"];m(o)&&(t=o)}if(m(e.locale)&&(l.locale=e.locale.toLowerCase()),void 0===t?l.language=l.locale:"en"!==t&&(l.language=t),function(e){return!0===e||!1===e}(e._languagePackSupport)&&(l.languagePackSupport=e._languagePackSupport),m(e._cacheRoot)&&(l.cacheRoot=e._cacheRoot),m(e._languagePackId)&&(l.languagePackId=e._languagePackId),m(e._translationsConfigFile)){l.translationsConfigFile=e._translationsConfigFile;try{l.translationsConfig=g(l.translationsConfigFile)}catch(t){if(e._corruptedFile){var a=h.dirname(e._corruptedFile);d.exists(a,(function(t){t&&d.writeFile(e._corruptedFile,"corrupted","utf8",(function(e){console.error(e)}))}))}}}}catch(e){}r="pseudo"===l.locale,s=Object.create(null)}(),t.loadMessageBundle=B,t.config=function(e){return e&&(m(e.locale)&&(l.locale=e.locale.toLowerCase(),l.language=l.locale,s=Object.create(null)),void 0!==e.messageFormat&&(l.messageFormat=e.messageFormat),e.bundleFormat===a.standalone&&!0===l.languagePackSupport&&(l.languagePackSupport=!1)),r="pseudo"===l.locale,B}},402:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.exists=t.AgentUtils=void 0;const i=o(331),a=o(747);class n{static async setupProvidersFromConnection(e){this._agentService=i.dataprotocol.getProvider(e.providerName,i.DataProviderType.AgentServicesProvider),this._connectionService=i.dataprotocol.getProvider(e.providerName,i.DataProviderType.ConnectionProvider),this._queryProvider=i.dataprotocol.getProvider(e.providerName,i.DataProviderType.QueryProvider)}static async getAgentService(){if(!n._agentService){let e=await i.connection.getCurrentConnection();this._agentService=i.dataprotocol.getProvider(e.providerId,i.DataProviderType.AgentServicesProvider)}return n._agentService}static async getDatabases(e){if(!n._connectionService){let e=await i.connection.getCurrentConnection();this._connectionService=i.dataprotocol.getProvider(e.providerId,i.DataProviderType.ConnectionProvider)}return n._connectionService.listDatabases(e).then((e=>{if(e&&e.databaseNames&&e.databaseNames.length>0)return e.databaseNames}))}static async getQueryProvider(){if(!n._queryProvider){let e=await i.connection.getCurrentConnection();this._queryProvider=i.dataprotocol.getProvider(e.providerId,i.DataProviderType.QueryProvider)}return this._queryProvider}}t.AgentUtils=n,t.exists=async function(e){try{return await a.promises.access(e),!0}catch(e){return!1}}},38:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AlertData=void 0;const i=o(403),a=o(549),n=o(331),s=o(402),l=o(912),r=i.loadMessageBundle(o(622).join(__dirname,"data/alertData.ts"));class h{constructor(e,t,o,i=!1){this.dialogMode=l.AgentDialogMode.CREATE,this.isEnabled=!0,this.alertType=h.DefaultAlertTypeString,this.ownerUri=e,this.viaJobDialog=i,this.jobModel=o,this.jobName=this.jobName?this.jobName:this.jobModel.name,t&&(this.dialogMode=l.AgentDialogMode.EDIT,this.id=t.id,this.name=t.name,this.originalName=t.name,this.delayBetweenResponses=t.delayBetweenResponses,this.eventDescriptionKeyword=t.eventDescriptionKeyword,this.eventSource=t.eventSource,this.hasNotification=t.hasNotification,this.includeEventDescription=t.includeEventDescription?t.includeEventDescription.toString():null,this.isEnabled=t.isEnabled,this.jobId=t.jobId,this.lastOccurrenceDate=t.lastOccurrenceDate,this.lastResponseDate=t.lastResponseDate,this.messageId=t.messageId,this.notificationMessage=t.notificationMessage,this.occurrenceCount=t.occurrenceCount,this.performanceCondition=t.performanceCondition,this.severity=t.severity,this.databaseName=t.databaseName,this.countResetDate=t.countResetDate,this.categoryName=t.categoryName,this.alertType=t.alertType?t.alertType.toString():null,this.wmiEventNamespace=t.wmiEventNamespace,this.wmiEventQuery=t.wmiEventQuery)}async initialize(){}async save(){let e,t=await s.AgentUtils.getAgentService();if(this.viaJobDialog){if(this.jobModel)return void Promise.resolve(this)}else e=await t.createAlert(this.ownerUri,this.toAgentAlertInfo());e&&e.success||a.window.showErrorMessage(r(0,null,e.errorMessage?e.errorMessage:"Unknown"))}toAgentAlertInfo(){return{id:this.id,name:this.name,delayBetweenResponses:this.delayBetweenResponses,eventDescriptionKeyword:this.eventDescriptionKeyword,eventSource:this.eventSource,hasNotification:this.hasNotification,includeEventDescription:n.NotifyMethods.none,isEnabled:this.isEnabled,jobId:this.jobId,jobName:this.jobName,lastOccurrenceDate:this.lastOccurrenceDate,lastResponseDate:this.lastResponseDate,messageId:this.messageId,notificationMessage:this.notificationMessage,occurrenceCount:this.occurrenceCount,performanceCondition:this.performanceCondition,severity:this.severity,databaseName:this.databaseName,countResetDate:this.countResetDate,categoryName:this.categoryName,alertType:h.getAlertTypeFromString(this.alertType),wmiEventNamespace:this.wmiEventNamespace,wmiEventQuery:this.wmiEventQuery}}static getAlertTypeFromString(e){return e===h.AlertTypePerformanceConditionString?n.AlertType.sqlServerPerformanceCondition:e===h.AlertTypeWmiEventString?n.AlertType.wmiEvent:n.AlertType.sqlServerEvent}}t.AlertData=h,h.AlertTypeSqlServerEventString=r(1,null),h.AlertTypePerformanceConditionString=r(2,null),h.AlertTypeWmiEventString=r(3,null),h.DefaultAlertTypeString=h.AlertTypeSqlServerEventString},365:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.JobData=void 0;const i=o(403),a=o(331),n=o(549),s=o(402),l=o(912),r=i.loadMessageBundle(o(622).join(__dirname,"data/jobData.ts"));t.JobData=class{constructor(e,t,o){this._agentService=o,this.JobCompletionActionCondition_Always=r(0,null),this.JobCompletionActionCondition_OnFailure=r(1,null),this.JobCompletionActionCondition_OnSuccess=r(2,null),this.CreateJobErrorMessage_NameIsEmpty=r(3,null),this.dialogMode=l.AgentDialogMode.CREATE,this.enabled=!0,this.emailLevel=a.JobCompletionActionCondition.OnFailure,this.pageLevel=a.JobCompletionActionCondition.OnFailure,this.eventLogLevel=a.JobCompletionActionCondition.OnFailure,this.deleteLevel=a.JobCompletionActionCondition.OnSuccess,this._ownerUri=e,t&&(this.dialogMode=l.AgentDialogMode.EDIT,this.name=t.name,this.originalName=t.name,this.owner=t.owner,this.category=t.category,this.description=t.description,this.enabled=t.enabled,this.jobSteps=t.jobSteps,this.jobSchedules=t.jobSchedules,this.alerts=t.alerts,this.jobId=t.jobId,this.startStepId=t.startStepId,this.categoryId=t.categoryId,this.categoryType=t.categoryType)}get jobCategories(){return this._jobCategories}get jobCategoryIdsMap(){return this._jobCategoryIdsMap}get operators(){return this._operators}get ownerUri(){return this._ownerUri}get defaultOwner(){return this._defaultOwner}get JobCompletionActionConditions(){return this._jobCompletionActionConditions}async initialize(){this._agentService=await s.AgentUtils.getAgentService();let e=await this._agentService.getJobDefaults(this.ownerUri);e&&e.success&&(this._jobCategories=e.categories.map((e=>e.name)),this._jobCategoryIdsMap=e.categories,this._defaultOwner=e.owner,this._operators=["",this._defaultOwner],this.owner=this.owner?this.owner:this._defaultOwner),this._jobCompletionActionConditions=[{displayName:this.JobCompletionActionCondition_OnSuccess,name:a.JobCompletionActionCondition.OnSuccess.toString()},{displayName:this.JobCompletionActionCondition_OnFailure,name:a.JobCompletionActionCondition.OnFailure.toString()},{displayName:this.JobCompletionActionCondition_Always,name:a.JobCompletionActionCondition.Always.toString()}]}async save(){let e=this.toAgentJobInfo(),t=this.dialogMode===l.AgentDialogMode.CREATE?await this._agentService.createJob(this.ownerUri,e):await this._agentService.updateJob(this.ownerUri,this.originalName,e);t&&t.success?this.dialogMode===l.AgentDialogMode.EDIT?n.window.showInformationMessage(r(6,null,e.name)):n.window.showInformationMessage(r(7,null,e.name)):this.dialogMode===l.AgentDialogMode.EDIT?n.window.showErrorMessage(r(4,null,t.errorMessage?t.errorMessage:"Unknown")):n.window.showErrorMessage(r(5,null,t.errorMessage?t.errorMessage:"Unknown"))}validate(){let e=[];return this.name&&this.name.trim()||e.push(this.CreateJobErrorMessage_NameIsEmpty),{valid:0===e.length,errorMessages:e}}toAgentJobInfo(){return{name:this.name,owner:this.owner?this.owner:this.defaultOwner,description:this.description,emailLevel:this.emailLevel,pageLevel:this.pageLevel,eventLogLevel:this.eventLogLevel,deleteLevel:this.deleteLevel,operatorToEmail:this.operatorToEmail,operatorToPage:this.operatorToPage,enabled:this.enabled,category:this.category,alerts:this.alerts,jobSchedules:this.jobSchedules,jobSteps:this.jobSteps,currentExecutionStatus:0,lastRunOutcome:0,currentExecutionStep:"",hasTarget:!0,hasSchedule:!1,hasStep:!1,runnable:!0,categoryId:this.categoryId,categoryType:this.categoryType,lastRun:"",nextRun:"",jobId:this.jobId,startStepId:this.startStepId}}}},132:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.JobStepData=void 0;const i=o(331),a=o(403),n=o(549),s=o(402),l=o(912),r=o(634),h=a.loadMessageBundle(o(622).join(__dirname,"data/jobStepData.ts"));class d{constructor(e,t,o=!1){this.ownerUri=e,this.jobName=t.name,this.jobModel=t,this.viaJobDialog=o}async initialize(){}async save(){let e,t=await s.AgentUtils.getAgentService();if(this.viaJobDialog){if(this.jobModel)return void Promise.resolve(this)}else e=await t.createJobStep(this.ownerUri,d.convertToAgentJobStepInfo(this));e&&e.success||n.window.showErrorMessage(h(0,null,e.errorMessage?e.errorMessage:"Unknown"))}validate(){let e=[];return this.stepName&&this.stepName.trim()||e.push(d.CreateStepErrorMessage_StepNameIsEmpty),this.jobName&&this.jobName.trim()||e.push(d.CreateStepErrorMessage_JobNameIsEmpty),{valid:0===e.length,errorMessages:e}}static convertToJobStepData(e,t){let o=new d(t.ownerUri,t);return o.ownerUri=t.ownerUri,o.jobId=e.jobId,o.jobName=e.jobName,o.script=e.script,o.scriptName=e.scriptName,o.stepName=e.stepName,o.subSystem=e.subSystem,o.id=e.id,o.failureAction=e.failureAction,o.successAction=e.successAction,o.failStepId=e.failStepId,o.successStepId=e.successStepId,o.command=e.command,o.commandExecutionSuccessCode=e.commandExecutionSuccessCode,o.databaseName=e.databaseName,o.databaseUserName=e.databaseUserName,o.server=e.server,o.outputFileName=e.outputFileName,o.appendToLogFile=e.appendToLogFile,o.appendToStepHist=e.appendToStepHist,o.writeLogToTable=e.writeLogToTable,o.appendLogToTable=e.appendLogToTable,o.retryAttempts=e.retryAttempts,o.retryInterval=e.retryInterval,o.proxyName=e.proxyName,o.dialogMode=l.AgentDialogMode.EDIT,o.viaJobDialog=!0,o}static convertToAgentJobStepInfo(e){return{jobId:e.jobId,jobName:e.jobName,script:e.script,scriptName:e.scriptName,stepName:e.stepName,subSystem:e.subSystem,id:e.id,failureAction:e.failureAction,successAction:e.successAction,failStepId:e.failStepId,successStepId:e.successStepId,command:e.command,commandExecutionSuccessCode:e.commandExecutionSuccessCode,databaseName:e.databaseName,databaseUserName:e.databaseUserName,server:e.server,outputFileName:e.outputFileName,appendToLogFile:e.appendToLogFile,appendToStepHist:e.appendToStepHist,writeLogToTable:e.writeLogToTable,appendLogToTable:e.appendLogToTable,retryAttempts:e.retryAttempts,retryInterval:e.retryInterval,proxyName:e.proxyName}}static convertToAgentSubSystem(e){switch(e){case r.JobStepDialog.TSQLScript:return i.AgentSubSystem.TransactSql;case r.JobStepDialog.Powershell:return i.AgentSubSystem.PowerShell;case r.JobStepDialog.CmdExec:return i.AgentSubSystem.CmdExec;case r.JobStepDialog.ReplicationDistributor:return i.AgentSubSystem.Distribution;case r.JobStepDialog.ReplicationMerge:return i.AgentSubSystem.Merge;case r.JobStepDialog.ReplicationQueueReader:return i.AgentSubSystem.QueueReader;case r.JobStepDialog.ReplicationSnapshot:return i.AgentSubSystem.Snapshot;case r.JobStepDialog.ReplicationTransactionLogReader:return i.AgentSubSystem.LogReader;case r.JobStepDialog.AnalysisServicesCommand:return i.AgentSubSystem.AnalysisCommands;case r.JobStepDialog.AnalysisServicesQuery:return i.AgentSubSystem.AnalysisQuery;case r.JobStepDialog.ServicesPackage:return i.AgentSubSystem.Ssis;default:return i.AgentSubSystem.TransactSql}}static convertToSubSystemDisplayName(e){switch(e){case i.AgentSubSystem.TransactSql:return r.JobStepDialog.TSQLScript;case i.AgentSubSystem.PowerShell:return r.JobStepDialog.Powershell;case i.AgentSubSystem.CmdExec:return r.JobStepDialog.CmdExec;case i.AgentSubSystem.Distribution:return r.JobStepDialog.ReplicationDistributor;case i.AgentSubSystem.Merge:return r.JobStepDialog.ReplicationMerge;case i.AgentSubSystem.QueueReader:return r.JobStepDialog.ReplicationQueueReader;case i.AgentSubSystem.Snapshot:return r.JobStepDialog.ReplicationSnapshot;case i.AgentSubSystem.LogReader:return r.JobStepDialog.ReplicationTransactionLogReader;case i.AgentSubSystem.AnalysisCommands:return r.JobStepDialog.AnalysisServicesCommand;case i.AgentSubSystem.AnalysisQuery:return r.JobStepDialog.AnalysisServicesQuery;case i.AgentSubSystem.Ssis:return r.JobStepDialog.ServicesPackage;default:return r.JobStepDialog.TSQLScript}}static convertToStepCompletionAction(e){switch(e){case r.JobStepDialog.NextStep:return i.StepCompletionAction.GoToNextStep;case r.JobStepDialog.QuitJobReportingSuccess:return i.StepCompletionAction.QuitWithSuccess;case r.JobStepDialog.QuitJobReportingFailure:return i.StepCompletionAction.QuitWithFailure;default:return i.StepCompletionAction.GoToNextStep}}static convertToCompletionActionDisplayName(e){switch(e){case i.StepCompletionAction.GoToNextStep:return r.JobStepDialog.NextStep;case i.StepCompletionAction.QuitWithFailure:return r.JobStepDialog.QuitJobReportingFailure;case i.StepCompletionAction.QuitWithSuccess:return r.JobStepDialog.QuitJobReportingSuccess;default:return r.JobStepDialog.NextStep}}}t.JobStepData=d,d.CreateStepErrorMessage_JobNameIsEmpty=h(1,null),d.CreateStepErrorMessage_StepNameIsEmpty=h(2,null)},250:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NotebookData=void 0;const i=o(403),a=o(331),n=o(549),s=o(622),l=o(402),r=o(912),h=i.loadMessageBundle(o(622).join(__dirname,"data/notebookData.ts")),d=h(0,null),c=h(1,null),u=h(2,null),p=h(3,null),m=h(4,null),g=h(5,null),b=h(6,null),w=h(7,null),x=h(8,null);class S{constructor(e,t,o){if(this._agentService=o,this.dialogMode=r.AgentDialogMode.CREATE,this.enabled=!0,this.emailLevel=a.JobCompletionActionCondition.OnFailure,this.pageLevel=a.JobCompletionActionCondition.OnFailure,this.eventLogLevel=a.JobCompletionActionCondition.OnFailure,this.deleteLevel=a.JobCompletionActionCondition.OnSuccess,this._ownerUri=e,this.enabled=!0,t.notebookInfo){let e=t.notebookInfo;this.dialogMode=r.AgentDialogMode.EDIT,this.name=e.name,this.originalName=e.name,this.owner=e.owner,this.category=e.category,this.description=e.description,this.enabled=e.enabled,this.jobSteps=e.jobSteps,this.jobSchedules=e.jobSchedules,this.alerts=e.alerts,this.jobId=e.jobId,this.startStepId=e.startStepId,this.categoryId=e.categoryId,this.categoryType=e.categoryType,this.targetDatabase=e.targetDatabase,this.executeDatabase=e.executeDatabase}t.filePath&&(this.name=s.basename(t.filePath).split(".").slice(0,-1).join("."),this.templatePath=t.filePath),t.connection&&(this.connection=t.connection)}get jobCategories(){return this._jobCategories}get jobCategoryIdsMap(){return this._jobCategoryIdsMap}get operators(){return this._operators}get ownerUri(){return this._ownerUri}get defaultOwner(){return this._defaultOwner}get JobCompletionActionConditions(){return this._jobCompletionActionConditions}async initialize(){this.connection&&await l.AgentUtils.setupProvidersFromConnection(this.connection),this._agentService=await l.AgentUtils.getAgentService();let e=await this._agentService.getJobDefaults(this.ownerUri);e&&e.success&&(this._jobCategories=e.categories.map((e=>e.name)),this._jobCategoryIdsMap=e.categories,this._defaultOwner=e.owner,this._operators=["",this._defaultOwner],this.owner=this.owner?this.owner:this._defaultOwner),this._jobCompletionActionConditions=[{displayName:u,name:a.JobCompletionActionCondition.OnSuccess.toString()},{displayName:c,name:a.JobCompletionActionCondition.OnFailure.toString()},{displayName:d,name:a.JobCompletionActionCondition.Always.toString()}],this._agentService.getJobs(this.ownerUri).then((e=>{S.jobLists=e.jobs}))}async save(){let e=this.toAgentJobInfo(),t=this.dialogMode===r.AgentDialogMode.CREATE?await this._agentService.createNotebook(this.ownerUri,e,this.templatePath):await this._agentService.updateNotebook(this.ownerUri,this.originalName,e,this.templatePath);t&&t.success?this.dialogMode===r.AgentDialogMode.EDIT?n.window.showInformationMessage(h(11,null,e.name)):n.window.showInformationMessage(h(12,null,e.name)):this.dialogMode===r.AgentDialogMode.EDIT?n.window.showErrorMessage(h(9,null,t.errorMessage?t.errorMessage:"Unknown")):n.window.showErrorMessage(h(10,null,t.errorMessage?t.errorMessage:"Unknown"))}async validate(){let e=[];if(this.dialogMode!==r.AgentDialogMode.EDIT){if(this.name&&this.name.trim()||e.push(p),this.templatePath&&this.name.trim()||e.push(m),await(0,l.exists)(this.templatePath)||e.push(g),S.jobLists)for(let t=0;t<S.jobLists.length;t++)if(this.name===S.jobLists[t].name){e.push(x);break}}else this.templatePath&&""!==this.templatePath&&!await(0,l.exists)(this.templatePath)&&e.push(g);return"Select Database"===this.targetDatabase&&e.push(b),"Select Database"===this.executeDatabase&&e.push(w),{valid:0===e.length,errorMessages:e}}toAgentJobInfo(){return{name:this.name,owner:this.owner?this.owner:this.defaultOwner,description:this.description,emailLevel:this.emailLevel,pageLevel:this.pageLevel,eventLogLevel:this.eventLogLevel,deleteLevel:this.deleteLevel,operatorToEmail:this.operatorToEmail,operatorToPage:this.operatorToPage,enabled:this.enabled,category:this.category,alerts:this.alerts,jobSchedules:this.jobSchedules,jobSteps:this.jobSteps,targetDatabase:this.targetDatabase,executeDatabase:this.executeDatabase,templateId:this.templateId,currentExecutionStatus:0,lastRunOutcome:0,currentExecutionStep:"",hasTarget:!0,hasSchedule:!1,hasStep:!1,runnable:!0,categoryId:this.categoryId,categoryType:this.categoryType,lastRun:"",nextRun:"",jobId:this.jobId,startStepId:this.startStepId,lastRunNotebookError:""}}}t.NotebookData=S},523:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OperatorData=void 0;const i=o(331),a=o(402),n=o(912);t.OperatorData=class{constructor(e,t){this.dialogMode=n.AgentDialogMode.CREATE,this.ownerUri=e,t&&(this.dialogMode=n.AgentDialogMode.EDIT,this.name=t.name,this.id=t.id,this.emailAddress=t.emailAddress,this.enabled=t.enabled,this.lastEmailDate=t.lastEmailDate,this.lastNetSendDate=t.lastNetSendDate,this.lastPagerDate=t.lastPagerDate,this.pagerAddress=t.pagerAddress,this.categoryName=t.categoryName,this.pagerDays=t.pagerDays.toString(),this.saturdayPagerEndTime=t.saturdayPagerEndTime,this.saturdayPagerStartTime=t.saturdayPagerStartTime,this.sundayPagerEndTime=t.sundayPagerEndTime,this.sundayPagerStartTime=t.sundayPagerStartTime,this.netSendAddress=t.netSendAddress,this.weekdayPagerStartTime=t.weekdayPagerStartTime,this.weekdayPagerEndTime=t.weekdayPagerEndTime)}async initialize(){}async save(){let e=await a.AgentUtils.getAgentService(),t=await e.createOperator(this.ownerUri,this.toAgentOperatorInfo());!t||t.success}toAgentOperatorInfo(){return{name:this.name,id:this.id,emailAddress:this.emailAddress,enabled:this.enabled,lastEmailDate:this.lastEmailDate,lastNetSendDate:this.lastNetSendDate,lastPagerDate:this.lastPagerDate,pagerAddress:this.pagerAddress,categoryName:this.categoryName,pagerDays:i.WeekDays.weekDays,saturdayPagerEndTime:this.saturdayPagerEndTime,saturdayPagerStartTime:this.saturdayPagerStartTime,sundayPagerEndTime:this.sundayPagerEndTime,sundayPagerStartTime:this.sundayPagerStartTime,netSendAddress:this.netSendAddress,weekdayPagerStartTime:this.weekdayPagerStartTime,weekdayPagerEndTime:this.weekdayPagerEndTime}}}},293:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PickScheduleData=void 0;const i=o(402),a=o(912);t.PickScheduleData=class{constructor(e,t){this.dialogMode=a.AgentDialogMode.VIEW,this.ownerUri=e,this.jobName=t}async initialize(){let e=await i.AgentUtils.getAgentService();try{let t=await e.getJobSchedules(this.ownerUri);return this.initialized=!0,t&&t.success?(this.schedules=t.schedules,this.schedules):void 0}catch(e){throw e}}async save(){this.selectedSchedule.jobName=this.jobName}isInitialized(){return this.initialized}}},157:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyData=void 0;const i=o(403),a=o(549),n=o(402),s=o(912),l=i.loadMessageBundle(o(622).join(__dirname,"data/proxyData.ts"));t.ProxyData=class{constructor(e,t){this.dialogMode=s.AgentDialogMode.CREATE,this.ownerUri=e,t&&(this.accountName=t.accountName,this.credentialName=t.credentialName,this.description=t.description)}async initialize(){}async save(){let e=await n.AgentUtils.getAgentService(),t=this.toAgentProxyInfo(),o=await e.createProxy(this.ownerUri,t);o&&o.success?this.dialogMode===s.AgentDialogMode.EDIT?a.window.showInformationMessage(l(1,null,t.accountName)):a.window.showInformationMessage(l(2,null,t.accountName)):a.window.showErrorMessage(l(0,null,o.errorMessage?o.errorMessage:"Unknown"))}toAgentProxyInfo(){return{id:this.id,accountName:this.accountName,description:this.description,credentialName:this.credentialName,credentialIdentity:this.credentialIdentity,credentialId:this.credentialId,isEnabled:this.isEnabled}}}},992:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AgentDialog=void 0;const i=o(403),a=o(331),n=o(549),s=i.loadMessageBundle(o(622).join(__dirname,"dialogs/agentDialog.ts"));class l{constructor(e,t,o){this.ownerUri=e,this.model=t,this.title=o,this._onSuccess=new n.EventEmitter,this._isOpen=!1,this.onSuccess=this._onSuccess.event}get dialogMode(){return this.model.dialogMode}async openDialog(e){if(!this._isOpen){this._isOpen=!0;let t=e||null;this.dialog=a.window.createModelViewDialog(this.title,t),this.model.initialize(),await this.initializeDialog(this.dialog),this.dialog.okButton.label=l.OkButtonText,this.dialog.okButton.onClick((async()=>await this.execute())),this.dialog.cancelButton.label=l.CancelButtonText,this.dialog.cancelButton.onClick((async()=>await this.cancel())),a.window.openDialog(this.dialog)}}async execute(){this.updateModel(),await this.model.save(),this._isOpen=!1,this._onSuccess.fire(this.model)}async cancel(){this._isOpen=!1}getActualConditionValue(e,t){return e.checked?Number(this.getDropdownValue(t)):a.JobCompletionActionCondition.Never}getDropdownValue(e){return"string"==typeof e.value?e.value:e.value.name}setConditionDropdownSelectedValue(e,t){let o=0;for(o=0;o<e.values.length;o++)if(Number(e.values[o].name)===t){e.value=e.values[o];break}}get isOpen(){return this._isOpen}}t.AgentDialog=l,l.OkButtonText=s(0,null),l.CancelButtonText=s(1,null)},104:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AlertDialog=void 0;const i=o(403),a=o(331),n=o(992),s=o(402),l=o(38),r=o(290),h=o(275),d=i.loadMessageBundle(o(622).join(__dirname,"dialogs/alertDialog.ts"));class c extends n.AgentDialog{constructor(e,t,o,i=!1){super(e,new l.AlertData(e,o,t,i),o?c.EditDialogTitle:c.CreateDialogTitle),this.NewAlertDialog="NewAlertDialogOpen",this.EditAlertDialog="EditAlertDialogOpened",this.isEdit=!1,this.jobModel=t,this.jobId=this.jobId?this.jobId:this.jobModel.jobId,this.jobName=this.jobName?this.jobName:this.jobModel.name,this.isEdit=!!o,this.dialogName=this.isEdit?this.EditAlertDialog:this.NewAlertDialog}async initializeDialog(e){this.databases=await s.AgentUtils.getDatabases(this.ownerUri),this.databases.unshift(c.AllDatabases),this.generalTab=a.window.createTab(c.GeneralTabText),this.responseTab=a.window.createTab(c.ResponseTabText),this.optionsTab=a.window.createTab(c.OptionsTabText),this.initializeGeneralTab(this.databases,e),this.initializeResponseTab(),this.initializeOptionsTab(),e.content=[this.generalTab,this.responseTab,this.optionsTab]}initializeGeneralTab(e,t){this.generalTab.registerContent((async o=>{this.nameTextBox=o.modelBuilder.inputBox().component(),this.nameTextBox.required=!0,this.nameTextBox.onTextChanged((()=>{this.nameTextBox.value.length>0?t.okButton.enabled=!0:t.okButton.enabled=!1})),this.enabledCheckBox=o.modelBuilder.checkBox().withProps({label:c.EnabledCheckboxLabel}).component(),this.enabledCheckBox.checked=!0,this.databaseDropDown=o.modelBuilder.dropDown().withProps({value:e[0],values:e,width:"100%"}).component(),this.typeDropDown=o.modelBuilder.dropDown().withProps({value:"",values:c.AlertTypes,width:"100%"}).component(),this.severityRadioButton=o.modelBuilder.radioButton().withProps({value:"serverity",name:"alertTypeOptions",label:c.SeverityLabel,checked:!0}).component(),this.severityRadioButton.checked=!0,this.severityDropDown=o.modelBuilder.dropDown().withProps({value:c.AlertSeverities[0],values:c.AlertSeverities,width:"100%"}).component(),this.errorNumberRadioButton=o.modelBuilder.radioButton().withProps({value:"errorNumber",name:"alertTypeOptions",label:c.ErrorNumberLabel}).component(),this.errorNumberTextBox=o.modelBuilder.inputBox().withProps({width:"100%"}).component(),this.errorNumberTextBox.enabled=!1,this.errorNumberRadioButton.onDidClick((()=>{this.errorNumberTextBox.enabled=!0,this.severityDropDown.enabled=!1})),this.severityRadioButton.onDidClick((()=>{this.errorNumberTextBox.enabled=!1,this.severityDropDown.enabled=!0})),this.raiseAlertMessageCheckBox=o.modelBuilder.checkBox().withProps({label:c.RaiseIfMessageContainsLabel}).component(),this.raiseAlertMessageTextBox=o.modelBuilder.inputBox().component(),this.raiseAlertMessageTextBox.enabled=!1,this.raiseAlertMessageCheckBox.onChanged((()=>{this.raiseAlertMessageTextBox.enabled=this.raiseAlertMessageCheckBox.checked}));let i=o.modelBuilder.formContainer().withFormItems([{component:this.nameTextBox,title:c.NameLabel},{component:this.enabledCheckBox,title:""},{component:this.typeDropDown,title:c.TypeLabel},{components:[{component:this.databaseDropDown,title:c.DatabaseLabel},{component:this.severityRadioButton,title:""},{component:this.severityDropDown,title:""},{component:this.errorNumberRadioButton,title:""},{component:this.errorNumberTextBox,title:""},{component:this.raiseAlertMessageCheckBox,title:""},{component:this.raiseAlertMessageTextBox,title:c.MessageTextLabel}],title:c.EventAlertText}]).withLayout({width:"100%"}).component();if(await o.initializeModel(i),this.nameTextBox.value=this.model.name,this.raiseAlertMessageTextBox.value=this.model.eventDescriptionKeyword,this.typeDropDown.value=this.model.alertType,this.enabledCheckBox.checked=this.model.isEnabled,this.model.messageId>0&&(this.errorNumberRadioButton.checked=!0,this.errorNumberTextBox.value=this.model.messageId.toString()),this.model.severity>0&&(this.severityRadioButton.checked=!0,this.severityDropDown.value=this.severityDropDown.values[this.model.severity-1]),this.model.databaseName){let e=this.databases.indexOf(this.model.databaseName);e>=0&&(this.databaseDropDown.value=this.databases[e])}}))}initializeResponseTab(){this.responseTab.registerContent((async e=>{this.executeJobCheckBox=e.modelBuilder.checkBox().withProps({label:c.ExecuteJobCheckBoxLabel}).component(),this.executeJobTextBox=e.modelBuilder.inputBox().withProps({width:375}).component(),this.executeJobTextBox.enabled=!1,this.newJobButton=e.modelBuilder.button().withProps({label:c.NewJobButtonLabel,width:80,secondary:!0}).component(),this.newJobButton.enabled=!1,this.newJobButton.onDidClick((()=>{new h.JobDialog(this.ownerUri).openDialog()})),this.executeJobCheckBox.onChanged((()=>{this.executeJobCheckBox.checked?(this.executeJobTextBox.enabled=!0,this.newJobButton.enabled=!0):(this.executeJobTextBox.enabled=!1,this.newJobButton.enabled=!1)}));let t=e.modelBuilder.formContainer().withFormItems([{component:this.executeJobTextBox,title:c.ExecuteJobTextBoxLabel},{component:this.newJobButton,title:c.NewJobButtonLabel}],{componentWidth:"100%"}).component(),o=e.modelBuilder.text().withProps({value:"Feature Preview"}).component();this.notifyOperatorsCheckBox=e.modelBuilder.checkBox().withProps({label:c.NotifyOperatorsTextBoxLabel}).component(),this.notifyOperatorsCheckBox.enabled=!1,this.operatorsTable=e.modelBuilder.table().withProps({columns:[c.OperatorNameColumnLabel,c.OperatorEmailColumnLabel,c.OperatorPagerColumnLabel],data:[],height:500,width:375}).component(),this.newOperatorButton=e.modelBuilder.button().withProps({label:c.NewOperatorButtonLabel,width:80,secondary:!0}).component(),this.operatorsTable.enabled=!1,this.newOperatorButton.enabled=!1,this.newOperatorButton.onDidClick((()=>{new r.OperatorDialog(this.ownerUri).openDialog()})),this.notifyOperatorsCheckBox.onChanged((()=>{this.notifyOperatorsCheckBox.checked?(this.operatorsTable.enabled=!0,this.newOperatorButton.enabled=!0):(this.operatorsTable.enabled=!1,this.newOperatorButton.enabled=!1)}));let i=e.modelBuilder.formContainer().withFormItems([{component:this.operatorsTable,title:c.OperatorListLabel},{component:this.newOperatorButton,title:""}],{componentWidth:"100%"}).component(),a=e.modelBuilder.formContainer().withFormItems([{component:this.executeJobCheckBox,title:""},{component:t,title:""},{component:o,title:""},{component:this.notifyOperatorsCheckBox,title:""},{component:i,title:""}]).withLayout({width:"100%"}).component();await e.initializeModel(a)}))}initializeOptionsTab(){this.optionsTab.registerContent((async e=>{this.includeErrorInEmailTextBox=e.modelBuilder.checkBox().withProps({label:c.IncludeErrorInEmailCheckBoxLabel}).component(),this.includeErrorInPagerTextBox=e.modelBuilder.checkBox().withProps({label:c.IncludeErrorInPagerCheckBoxLabel}).component(),this.additionalMessageTextBox=e.modelBuilder.inputBox().component(),this.delayMinutesTextBox=e.modelBuilder.inputBox().withProps({inputType:"number",placeHolder:"0"}).component(),this.delaySecondsTextBox=e.modelBuilder.inputBox().withProps({inputType:"number",placeHolder:"0"}).component();let t=e.modelBuilder.formContainer().withFormItems([{component:this.includeErrorInEmailTextBox,title:""},{component:this.includeErrorInPagerTextBox,title:""},{component:this.additionalMessageTextBox,title:c.AdditionalMessageTextBoxLabel},{component:this.delayMinutesTextBox,title:c.DelayMinutesTextBoxLabel},{component:this.delaySecondsTextBox,title:c.DelaySecondsTextBoxLabel}]).withLayout({width:"100%"}).component();await e.initializeModel(t)}))}getSeverityNumber(){let e=this.getDropdownValue(this.severityDropDown),t=0;if(e){let o=c.AlertSeverities.indexOf(e);o>=0&&(t=o+1)}return t}async updateModel(){this.model.name=this.nameTextBox.value,this.model.isEnabled=this.enabledCheckBox.checked,this.model.jobId=this.jobId,this.model.jobName=this.jobName,this.model.alertType=this.getDropdownValue(this.typeDropDown);let e=this.getDropdownValue(this.databaseDropDown);this.model.databaseName=e!==c.AllDatabases?e:void 0,this.severityRadioButton.checked?(this.model.severity=this.getSeverityNumber(),this.model.messageId=0):(this.model.severity=0,this.model.messageId=+this.errorNumberTextBox.value),this.raiseAlertMessageCheckBox.checked?this.model.eventDescriptionKeyword=this.raiseAlertMessageTextBox.value:this.model.eventDescriptionKeyword="";let t=this.delayMinutesTextBox.value?+this.delayMinutesTextBox.value:0,o=this.delaySecondsTextBox.value?+this.delaySecondsTextBox:0;this.model.delayBetweenResponses=t+o}}t.AlertDialog=c,c.CreateDialogTitle=d(0,null),c.EditDialogTitle=d(1,null),c.GeneralTabText=d(2,null),c.ResponseTabText=d(3,null),c.OptionsTabText=d(4,null),c.EventAlertText=d(5,null),c.NameLabel=d(6,null),c.TypeLabel=d(7,null),c.EnabledCheckboxLabel=d(8,null),c.DatabaseLabel=d(9,null),c.ErrorNumberLabel=d(10,null),c.SeverityLabel=d(11,null),c.RaiseIfMessageContainsLabel=d(12,null),c.MessageTextLabel=d(13,null),c.AlertSeverity001Label=d(14,null),c.AlertSeverity002Label=d(15,null),c.AlertSeverity003Label=d(16,null),c.AlertSeverity004Label=d(17,null),c.AlertSeverity005Label=d(18,null),c.AlertSeverity006Label=d(19,null),c.AlertSeverity007Label=d(20,null),c.AlertSeverity008Label=d(21,null),c.AlertSeverity009Label=d(22,null),c.AlertSeverity010Label=d(23,null),c.AlertSeverity011Label=d(24,null),c.AlertSeverity012Label=d(25,null),c.AlertSeverity013Label=d(26,null),c.AlertSeverity014Label=d(27,null),c.AlertSeverity015Label=d(28,null),c.AlertSeverity016Label=d(29,null),c.AlertSeverity017Label=d(30,null),c.AlertSeverity018Label=d(31,null),c.AlertSeverity019Label=d(32,null),c.AlertSeverity020Label=d(33,null),c.AlertSeverity021Label=d(34,null),c.AlertSeverity022Label=d(35,null),c.AlertSeverity023Label=d(36,null),c.AlertSeverity024Label=d(37,null),c.AlertSeverity025Label=d(38,null),c.AllDatabases=d(39,null),c.AlertTypes=[l.AlertData.AlertTypeSqlServerEventString],c.AlertSeverities=[c.AlertSeverity001Label,c.AlertSeverity002Label,c.AlertSeverity003Label,c.AlertSeverity004Label,c.AlertSeverity005Label,c.AlertSeverity006Label,c.AlertSeverity007Label,c.AlertSeverity008Label,c.AlertSeverity009Label,c.AlertSeverity010Label,c.AlertSeverity011Label,c.AlertSeverity012Label,c.AlertSeverity013Label,c.AlertSeverity014Label,c.AlertSeverity015Label,c.AlertSeverity016Label,c.AlertSeverity017Label,c.AlertSeverity018Label,c.AlertSeverity019Label,c.AlertSeverity020Label,c.AlertSeverity021Label,c.AlertSeverity022Label,c.AlertSeverity023Label,c.AlertSeverity024Label,c.AlertSeverity025Label],c.ExecuteJobCheckBoxLabel=d(40,null),c.ExecuteJobTextBoxLabel=d(41,null),c.NotifyOperatorsTextBoxLabel=d(42,null),c.NewJobButtonLabel=d(43,null),c.OperatorListLabel=d(44,null),c.OperatorNameColumnLabel=d(45,null),c.OperatorEmailColumnLabel=d(46,null),c.OperatorPagerColumnLabel=d(47,null),c.NewOperatorButtonLabel=d(48,null),c.IncludeErrorInEmailCheckBoxLabel=d(49,null),c.IncludeErrorInPagerCheckBoxLabel=d(50,null),c.AdditionalMessageTextBoxLabel=d(51,null),c.DelayMinutesTextBoxLabel=d(52,null),c.DelaySecondsTextBoxLabel=d(53,null)},275:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.JobDialog=void 0;const i=o(403),a=o(331),n=o(365),s=o(634),l=o(453),r=o(104),h=o(992),d=o(402),c=o(132),u=i.loadMessageBundle(o(622).join(__dirname,"dialogs/jobDialog.ts"));class p extends h.AgentDialog{constructor(e,t){super(e,new n.JobData(e,t),t?p.EditDialogTitle:p.CreateDialogTitle),this.GeneralTabText=u(0,null),this.StepsTabText=u(1,null),this.SchedulesTabText=u(2,null),this.AlertsTabText=u(3,null),this.NotificationsTabText=u(4,null),this.BlankJobNameErrorText=u(5,null),this.NameTextBoxLabel=u(6,null),this.OwnerTextBoxLabel=u(7,null),this.CategoryDropdownLabel=u(8,null),this.DescriptionTextBoxLabel=u(9,null),this.EnabledCheckboxLabel=u(10,null),this.JobStepsTopLabelString=u(11,null),this.StepsTable_StepColumnString=u(12,null),this.StepsTable_NameColumnString=u(13,null),this.StepsTable_TypeColumnString=u(14,null),this.StepsTable_SuccessColumnString=u(15,null),this.StepsTable_FailureColumnString=u(16,null),this.NewStepButtonString=u(17,null),this.EditStepButtonString=u(18,null),this.DeleteStepButtonString=u(19,null),this.MoveStepUpButtonString=u(20,null),this.MoveStepDownButtonString=u(21,null),this.StartStepDropdownString=u(22,null),this.NotificationsTabTopLabelString=u(23,null),this.EmailCheckBoxString=u(24,null),this.PagerCheckBoxString=u(25,null),this.EventLogCheckBoxString=u(26,null),this.DeleteJobCheckBoxString=u(27,null),this.SchedulesTopLabelString=u(28,null),this.PickScheduleButtonString=u(29,null),this.RemoveScheduleButtonString=u(30,null),this.AlertsTopLabelString=u(31,null),this.NewAlertButtonString=u(32,null),this.AlertNameLabelString=u(33,null),this.AlertEnabledLabelString=u(34,null),this.AlertTypeLabelString=u(35,null),this.NewJobDialogEvent="NewJobDialogOpened",this.EditJobDialogEvent="EditJobDialogOpened",this.isEdit=!1,this.alerts=[],this.startStepDropdownValues=[],this.steps=this.model.jobSteps?this.model.jobSteps:[],this.schedules=this.model.jobSchedules?this.model.jobSchedules:[],this.alerts=this.model.alerts?this.model.alerts:[],this.isEdit=!!t,this.dialogName=this.isEdit?this.EditJobDialogEvent:this.NewJobDialogEvent}async initializeDialog(){this.generalTab=a.window.createTab(this.GeneralTabText),this.stepsTab=a.window.createTab(this.StepsTabText),this.alertsTab=a.window.createTab(this.AlertsTabText),this.schedulesTab=a.window.createTab(this.SchedulesTabText),this.notificationsTab=a.window.createTab(this.NotificationsTabText),this.initializeGeneralTab(),this.initializeStepsTab(),this.initializeAlertsTab(),this.initializeSchedulesTab(),this.initializeNotificationsTab(),this.dialog.content=[this.generalTab,this.stepsTab,this.schedulesTab,this.alertsTab,this.notificationsTab],this.dialog.registerCloseValidator((()=>{this.updateModel();let e=this.model.validate();return e.valid||console.error(e.errorMessages.join(",")),e.valid}))}initializeGeneralTab(){this.generalTab.registerContent((async e=>{this.nameTextBox=e.modelBuilder.inputBox().component(),this.nameTextBox.required=!0,this.nameTextBox.onTextChanged((()=>{this.nameTextBox.value&&this.nameTextBox.value.length>0&&(this.dialog.message=null,this.model.name=this.nameTextBox.value)})),this.ownerTextBox=e.modelBuilder.inputBox().component(),this.categoryDropdown=e.modelBuilder.dropDown().component(),this.descriptionTextBox=e.modelBuilder.inputBox().withProps({multiline:!0,height:200}).component(),this.enabledCheckBox=e.modelBuilder.checkBox().withProps({label:this.EnabledCheckboxLabel}).component();let t,o=e.modelBuilder.formContainer().withFormItems([{component:this.nameTextBox,title:this.NameTextBoxLabel},{component:this.ownerTextBox,title:this.OwnerTextBoxLabel},{component:this.categoryDropdown,title:this.CategoryDropdownLabel},{component:this.descriptionTextBox,title:this.DescriptionTextBoxLabel},{component:this.enabledCheckBox,title:""}]).withLayout({width:"100%"}).component();await e.initializeModel(o),this.nameTextBox.value=this.model.name,this.ownerTextBox.value=this.model.owner,this.categoryDropdown.values=this.model.jobCategories,this.model.category&&""!==this.model.category&&(t=this.model.jobCategories.indexOf(this.model.category)),this.categoryDropdown.value=this.model.jobCategories[t>0?t:0],this.enabledCheckBox.checked=this.model.enabled,this.descriptionTextBox.value=this.model.description}))}initializeStepsTab(){this.stepsTab.registerContent((async e=>{let t=this.steps?this.convertStepsToData(this.steps):[];this.stepsTable=e.modelBuilder.table().withProps({columns:[this.StepsTable_StepColumnString,this.StepsTable_NameColumnString,this.StepsTable_TypeColumnString,this.StepsTable_SuccessColumnString,this.StepsTable_FailureColumnString],data:t,height:500}).component(),this.startStepDropdown=e.modelBuilder.dropDown().withProps({width:180}).component(),this.startStepDropdown.enabled=this.steps.length>=1,this.steps.forEach((e=>{this.startStepDropdownValues.push({displayName:e.id+": "+e.stepName,name:e.id.toString()})})),this.startStepDropdown.values=this.startStepDropdownValues,this.moveStepUpButton=e.modelBuilder.button().withProps({label:this.MoveStepUpButtonString,title:this.MoveStepUpButtonString,width:120,secondary:!0}).component(),this.moveStepDownButton=e.modelBuilder.button().withProps({label:this.MoveStepDownButtonString,title:this.MoveStepDownButtonString,width:120,secondary:!0}).component(),this.moveStepUpButton.enabled=!1,this.moveStepDownButton.enabled=!1,this.newStepButton=e.modelBuilder.button().withProps({label:this.NewStepButtonString,title:this.NewStepButtonString,width:140,secondary:!0}).component(),this.newStepButton.onDidClick((e=>{if(this.nameTextBox.value&&this.nameTextBox.value.length>0){let e=new s.JobStepDialog(this.model.ownerUri,"",this.model,null,!0);e.onSuccess((e=>{let t=c.JobStepData.convertToAgentJobStepInfo(e);this.steps.push(t),this.stepsTable.data=this.convertStepsToData(this.steps),this.startStepDropdownValues=[],this.steps.forEach((e=>{this.startStepDropdownValues.push({displayName:e.id+": "+e.stepName,name:e.id.toString()})})),this.startStepDropdown.values=this.startStepDropdownValues,this.startStepDropdown.enabled=!0,this.model.jobSteps=this.steps})),e.jobName=this.nameTextBox.value,e.openDialog()}else this.dialog.message={text:this.BlankJobNameErrorText}})),this.editStepButton=e.modelBuilder.button().withProps({label:this.EditStepButtonString,title:this.EditStepButtonString,width:140,secondary:!0}).component(),this.deleteStepButton=e.modelBuilder.button().withProps({label:this.DeleteStepButtonString,title:this.DeleteStepButtonString,width:140,secondary:!0}).component(),this.stepsTable.enabled=!1,this.editStepButton.enabled=!1,this.deleteStepButton.enabled=!1,this.moveStepUpButton.onDidClick((()=>{let e=this.stepsTable.selectedRows[0],t=e-1,o=this.steps[t],i=this.steps[t].id,a=this.steps[e],n=this.steps[e].id;this.steps[t]=a,this.steps[e]=o,this.stepsTable.data=this.convertStepsToData(this.steps),this.steps[t].id=i,this.steps[e].id=n,this.stepsTable.selectedRows=[t]})),this.moveStepDownButton.onDidClick((()=>{let e=this.stepsTable.selectedRows[0],t=e+1,o=this.steps[t],i=this.steps[t].id,a=this.steps[e],n=this.steps[e].id;this.steps[t]=a,this.steps[e]=o,this.stepsTable.data=this.convertStepsToData(this.steps),this.steps[t].id=i,this.steps[e].id=n,this.stepsTable.selectedRows=[t]})),this.editStepButton.onDidClick((()=>{if(1===this.stepsTable.selectedRows.length){let e=this.stepsTable.selectedRows[0],t=this.model.jobSteps[e],o=new s.JobStepDialog(this.model.ownerUri,"",this.model,t,!0);o.onSuccess((e=>{let t=c.JobStepData.convertToAgentJobStepInfo(e);for(let e=0;e<this.steps.length;e++)this.steps[e].id===t.id&&(this.steps[e]=t);this.stepsTable.data=this.convertStepsToData(this.steps),this.startStepDropdownValues=[],this.steps.forEach((e=>{this.startStepDropdownValues.push({displayName:e.id+": "+e.stepName,name:e.id.toString()})})),this.startStepDropdown.values=this.startStepDropdownValues,this.model.jobSteps=this.steps})),o.openDialog()}})),this.deleteStepButton.onDidClick((async()=>{if(1===this.stepsTable.selectedRows.length){let e=this.stepsTable.selectedRows[0];d.AgentUtils.getAgentService().then((async t=>{let o=this.steps[e];if(o.jobId)await t.deleteJobStep(this.ownerUri,o).then((t=>{if(t&&t.success){this.steps.splice(e,1);let t=this.convertStepsToData(this.steps);this.stepsTable.data=t,this.startStepDropdownValues=[],this.steps.forEach((e=>{this.startStepDropdownValues.push({displayName:e.id+": "+e.stepName,name:e.id.toString()})})),this.startStepDropdown.values=this.startStepDropdownValues}}));else{this.steps.splice(e,1);let t=this.convertStepsToData(this.steps);this.stepsTable.data=t,this.startStepDropdownValues=[],this.steps.forEach((e=>{this.startStepDropdownValues.push({displayName:e.id+": "+e.stepName,name:e.id.toString()})})),this.startStepDropdown.values=this.startStepDropdownValues,this.startStepDropdown.enabled=this.steps.length>=1}this.model.jobSteps=this.steps}))}})),this.stepsTable.onRowSelected((e=>{if(1===this.stepsTable.selectedRows.length){let e=this.stepsTable.selectedRows[0];this.steps.length!==e+1&&(this.moveStepDownButton.enabled=!0),0!==e&&(this.moveStepUpButton.enabled=!0),this.deleteStepButton.enabled=!0,this.editStepButton.enabled=!0}}));let o=this.createRowContainer(e).withItems([this.startStepDropdown,this.moveStepUpButton,this.moveStepDownButton]).component(),i=this.createRowContainer(e).withItems([this.newStepButton,this.editStepButton,this.deleteStepButton]).component(),a=e.modelBuilder.formContainer().withFormItems([{component:this.stepsTable,title:this.JobStepsTopLabelString},{component:o,title:this.StartStepDropdownString},{component:i,title:""}]).withLayout({width:"100%"}).component();await e.initializeModel(a),this.setConditionDropdownSelectedValue(this.startStepDropdown,this.model.startStepId)}))}initializeAlertsTab(){this.alertsTab.registerContent((async e=>{let t=this.model.alerts?this.model.alerts:[],o=this.convertAlertsToData(t);this.alertsTable=e.modelBuilder.table().withProps({columns:[this.AlertNameLabelString,this.AlertEnabledLabelString,this.AlertTypeLabelString],data:o,height:750,width:400}).component(),this.newAlertButton=e.modelBuilder.button().withProps({label:this.NewAlertButtonString,width:80,secondary:!0}).component();let i=new r.AlertDialog(this.model.ownerUri,this.model,null,!0);i.onSuccess((e=>{let t=e.toAgentAlertInfo();this.alerts.push(t),this.alertsTable.data=this.convertAlertsToData(this.alerts)})),this.newAlertButton.onDidClick((()=>{this.nameTextBox.value&&this.nameTextBox.value.length>0?(i.jobId=this.model.jobId,i.jobName=this.model.name?this.model.name:this.nameTextBox.value,i.openDialog()):this.dialog.message={text:this.BlankJobNameErrorText}}));let a=e.modelBuilder.formContainer().withFormItems([{component:this.alertsTable,title:this.AlertsTopLabelString,actions:[this.newAlertButton]}]).withLayout({width:"100%"}).component();await e.initializeModel(a)}))}initializeSchedulesTab(){this.schedulesTab.registerContent((async e=>{this.schedulesTable=e.modelBuilder.table().withProps({columns:[l.PickScheduleDialog.SchedulesIDText,l.PickScheduleDialog.ScheduleNameLabelText,l.PickScheduleDialog.ScheduleDescription],data:[],height:750,width:420}).component(),this.pickScheduleButton=e.modelBuilder.button().withProps({label:this.PickScheduleButtonString,secondary:!0}).component(),this.removeScheduleButton=e.modelBuilder.button().withProps({label:this.RemoveScheduleButtonString,secondary:!0}).component(),this.pickScheduleButton.onDidClick((()=>{let e=new l.PickScheduleDialog(this.model.ownerUri,this.model.name);e.onSuccess((e=>{let t=e.selectedSchedule;t&&(this.schedules.find((e=>e.name===t.name))||(t.jobName=this.model.name?this.model.name:this.nameTextBox.value,this.schedules.push(t)),this.populateScheduleTable())})),e.showDialog()})),this.removeScheduleButton.onDidClick((()=>{if(1===this.schedulesTable.selectedRows.length){let e=this.schedulesTable.selectedRows[0],t=this.schedulesTable.data[e][1];for(let e=0;e<this.schedules.length;e++)this.schedules[e].name===t&&this.schedules.splice(e,1);this.populateScheduleTable()}}));let t=e.modelBuilder.formContainer().withFormItems([{component:this.schedulesTable,title:this.SchedulesTopLabelString,actions:[this.pickScheduleButton,this.removeScheduleButton]}]).withLayout({width:"100%"}).component();await e.initializeModel(t),this.populateScheduleTable()}))}populateScheduleTable(){let e=this.convertSchedulesToData(this.schedules);this.schedulesTable.data=e,this.schedulesTable.height=750}initializeNotificationsTab(){this.notificationsTab.registerContent((async e=>{this.emailCheckBox=e.modelBuilder.checkBox().withProps({label:this.EmailCheckBoxString,width:"20%"}).component(),this.pagerCheckBox=e.modelBuilder.checkBox().withProps({label:this.PagerCheckBoxString,width:"20%"}).component(),this.eventLogCheckBox=e.modelBuilder.checkBox().withProps({label:this.EventLogCheckBoxString,width:"5%"}).component(),this.deleteJobCheckBox=e.modelBuilder.checkBox().withProps({label:this.DeleteJobCheckBoxString,width:"7%"}).component(),this.emailCheckBox.onChanged((()=>{this.emailConditionDropdown.enabled=this.emailCheckBox.checked,this.emailOperatorDropdown.enabled=this.emailCheckBox.checked})),this.pagerCheckBox.onChanged((()=>{this.pagerConditionDropdown.enabled=this.pagerCheckBox.checked,this.pagerOperatorDropdown.enabled=this.pagerCheckBox.checked})),this.eventLogCheckBox.onChanged((()=>{this.eventLogConditionDropdown.enabled=this.eventLogCheckBox.checked})),this.deleteJobCheckBox.onChanged((()=>{this.deleteJobConditionDropdown.enabled=this.deleteJobCheckBox.checked})),this.emailOperatorDropdown=e.modelBuilder.dropDown().withProps({width:"90%"}).component(),this.pagerOperatorDropdown=e.modelBuilder.dropDown().withProps({width:"90%"}).component(),this.emailConditionDropdown=e.modelBuilder.dropDown().withProps({width:"80%"}).component(),this.pagerConditionDropdown=e.modelBuilder.dropDown().withProps({width:"80%"}).component(),this.eventLogConditionDropdown=e.modelBuilder.dropDown().withProps({width:"80%"}).component(),this.deleteJobConditionDropdown=e.modelBuilder.dropDown().withProps({width:"85%"}).component();let t=this.createRowContainer(e).withItems([this.emailCheckBox,this.emailOperatorDropdown,this.emailConditionDropdown]).component(),o=this.createRowContainer(e).withItems([this.pagerCheckBox,this.pagerOperatorDropdown,this.pagerConditionDropdown]).component(),i=this.createRowContainer(e).withItems([this.eventLogCheckBox,this.eventLogConditionDropdown]).component(),a=this.createRowContainer(e).withItems([this.deleteJobCheckBox,this.deleteJobConditionDropdown]).component(),n=e.modelBuilder.formContainer().withFormItems([{components:[{component:t,title:""},{component:o,title:""},{component:i,title:""},{component:a,title:""}],title:this.NotificationsTabTopLabelString}]).withLayout({width:"100%"}).component();await e.initializeModel(n),this.emailConditionDropdown.values=this.model.JobCompletionActionConditions,this.pagerConditionDropdown.values=this.model.JobCompletionActionConditions,this.eventLogConditionDropdown.values=this.model.JobCompletionActionConditions,this.deleteJobConditionDropdown.values=this.model.JobCompletionActionConditions,this.setConditionDropdownSelectedValue(this.emailConditionDropdown,this.model.emailLevel),this.setConditionDropdownSelectedValue(this.pagerConditionDropdown,this.model.pageLevel),this.setConditionDropdownSelectedValue(this.eventLogConditionDropdown,this.model.eventLogLevel),this.setConditionDropdownSelectedValue(this.deleteJobConditionDropdown,this.model.deleteLevel),this.emailOperatorDropdown.values=this.model.operators,this.pagerOperatorDropdown.values=this.model.operators,this.emailCheckBox.checked=!1,this.pagerCheckBox.checked=!1,this.eventLogCheckBox.checked=!1,this.deleteJobCheckBox.checked=!1,this.emailOperatorDropdown.enabled=!1,this.pagerOperatorDropdown.enabled=!1,this.emailConditionDropdown.enabled=!1,this.pagerConditionDropdown.enabled=!1,this.eventLogConditionDropdown.enabled=!1,this.deleteJobConditionDropdown.enabled=!1}))}createRowContainer(e){return e.modelBuilder.flexContainer().withLayout({flexFlow:"row",justifyContent:"space-between"})}convertStepsToData(e){let t=[];return e.forEach((e=>{let o=[];o.push(e.id),o.push(e.stepName),o.push(c.JobStepData.convertToSubSystemDisplayName(e.subSystem)),o.push(c.JobStepData.convertToCompletionActionDisplayName(e.successAction)),o.push(c.JobStepData.convertToCompletionActionDisplayName(e.failureAction)),t.push(o)})),t}convertSchedulesToData(e){let t=[];return e.forEach((e=>{let o=[];o.push(e.id),o.push(e.name),o.push(e.description),t.push(o)})),t}convertAlertsToData(e){let t=[];return e.forEach((e=>{let o=[];o.push(e.name),o.push(e.isEnabled),o.push(e.alertType.toString()),t.push(o)})),t}async updateModel(){this.model.name=this.nameTextBox.value,this.model.owner=this.ownerTextBox.value,this.model.enabled=this.enabledCheckBox.checked,this.model.description=this.descriptionTextBox.value,this.model.category=this.getDropdownValue(this.categoryDropdown),this.model.emailLevel=this.getActualConditionValue(this.emailCheckBox,this.emailConditionDropdown),this.model.operatorToEmail=this.getDropdownValue(this.emailOperatorDropdown),this.model.operatorToPage=this.getDropdownValue(this.pagerOperatorDropdown),this.model.pageLevel=this.getActualConditionValue(this.pagerCheckBox,this.pagerConditionDropdown),this.model.eventLogLevel=this.getActualConditionValue(this.eventLogCheckBox,this.eventLogConditionDropdown),this.model.deleteLevel=this.getActualConditionValue(this.deleteJobCheckBox,this.deleteJobConditionDropdown),this.model.startStepId=this.startStepDropdown.enabled?+this.getDropdownValue(this.startStepDropdown):1,this.model.jobSteps||(this.model.jobSteps=[]),this.model.jobSteps=this.steps,this.model.jobSteps.length>0&&(this.model.jobSteps[this.model.jobSteps.length-1].successAction=a.StepCompletionAction.QuitWithSuccess),this.model.jobSchedules||(this.model.jobSchedules=[]),this.model.jobSchedules=this.schedules,this.model.alerts||(this.model.alerts=[]),this.model.alerts=this.alerts,this.model.categoryId=+this.model.jobCategoryIdsMap.find((e=>e.name===this.model.category)).id}}t.JobDialog=p,p.CreateDialogTitle=u(36,null),p.EditDialogTitle=u(37,null)},634:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.JobStepDialog=void 0;const i=o(403),a=o(331),n=o(132),s=o(402),l=o(992),r=o(912),h=o(622),d=i.loadMessageBundle(o(622).join(__dirname,"dialogs/jobStepDialog.ts"));class c extends l.AgentDialog{constructor(e,t,o,i,a=!1){super(e,i?n.JobStepData.convertToJobStepData(i,o):new n.JobStepData(e,o,a),i?c.EditDialogTitle:c.NewDialogTitle),this.FileBrowserDialogTitle=d(0,null),this.OkButtonText=d(1,null),this.CancelButtonText=d(2,null),this.GeneralTabText=d(3,null),this.AdvancedTabText=d(4,null),this.OpenCommandText=d(5,null),this.ParseCommandText=d(6,null),this.SuccessfulParseText=d(7,null),this.FailureParseText=d(8,null),this.BlankStepNameErrorText=d(9,null),this.ProcessExitCodeText=d(10,null),this.StepNameLabelString=d(11,null),this.TypeLabelString=d(12,null),this.RunAsLabelString=d(13,null),this.DatabaseLabelString=d(14,null),this.CommandLabelString=d(15,null),this.SuccessActionLabel=d(16,null),this.FailureActionLabel=d(17,null),this.RunAsUserLabel=d(18,null),this.RetryAttemptsLabel=d(19,null),this.RetryIntervalLabel=d(20,null),this.LogToTableLabel=d(21,null),this.AppendExistingTableEntryLabel=d(22,null),this.IncludeStepOutputHistoryLabel=d(23,null),this.OutputFileNameLabel=d(24,null),this.AppendOutputToFileLabel=d(25,null),this.SelectedPathLabelString=d(26,null),this.FilesOfTypeLabelString=d(27,null),this.FileNameLabelString=d(28,null),this.AllFilesLabelString=d(29,null),this.NewStepDialog="NewStepDialogOpened",this.EditStepDialog="EditStepDialogOpened",this.stepId=i?i.id:o.jobSteps?o.jobSteps.length+1:1,this.isEdit=!!i,this.model.dialogMode=this.isEdit?r.AgentDialogMode.EDIT:r.AgentDialogMode.CREATE,this.jobModel=o,this.jobName=this.jobName?this.jobName:this.jobModel.name,this.server=t,this.dialogName=this.isEdit?this.EditStepDialog:this.NewStepDialog}initializeUIComponents(){this.generalTab=a.window.createTab(this.GeneralTabText),this.advancedTab=a.window.createTab(this.AdvancedTabText),this.dialog.content=[this.generalTab,this.advancedTab]}createCommands(e,t){this.openButton=e.modelBuilder.button().withProps({label:this.OpenCommandText,title:this.OpenCommandText,width:"80px",isFile:!0,secondary:!0}).component(),this.parseButton=e.modelBuilder.button().withProps({label:this.ParseCommandText,title:this.ParseCommandText,width:"80px",isFile:!1,secondary:!0}).component(),this.openButton.onDidClick((e=>{let t=e.fileContent;this.commandTextBox.value=t})),this.parseButton.onDidClick((e=>{this.commandTextBox.value&&t.parseSyntax(this.ownerUri,this.commandTextBox.value).then((e=>{e&&e.parseable?this.dialog.message={text:this.SuccessfulParseText,level:2}:e&&!e.parseable&&(this.dialog.message={text:this.FailureParseText})}))})),this.commandTextBox=e.modelBuilder.inputBox().withProps({height:300,width:400,multiline:!0,inputType:"text",ariaLabel:this.CommandLabelString,placeHolder:this.CommandLabelString}).component()}createGeneralTab(e,t){this.generalTab.registerContent((async o=>{this.nameTextBox=o.modelBuilder.inputBox().withProps({ariaLabel:this.StepNameLabelString,placeHolder:this.StepNameLabelString}).component(),this.nameTextBox.required=!0,this.nameTextBox.onTextChanged((()=>{this.nameTextBox.value.length>0&&(this.dialog.message=null)})),this.typeDropdown=o.modelBuilder.dropDown().withProps({value:c.TSQLScript,values:[c.TSQLScript,c.CmdExec,c.Powershell]}).component(),this.runAsDropdown=o.modelBuilder.dropDown().withProps({value:"",values:[""]}).component(),this.runAsDropdown.enabled=!1,this.databaseDropdown=o.modelBuilder.dropDown().withProps({value:e[0],values:e}).component(),this.processExitCodeBox=o.modelBuilder.inputBox().withProps({ariaLabel:this.ProcessExitCodeText,placeHolder:this.ProcessExitCodeText}).component(),this.processExitCodeBox.enabled=!1,this.createCommands(o,t);let i=o.modelBuilder.formContainer().withFormItems([{component:this.nameTextBox,title:this.StepNameLabelString},{component:this.typeDropdown,title:this.TypeLabelString},{component:this.runAsDropdown,title:this.RunAsLabelString},{component:this.databaseDropdown,title:this.DatabaseLabelString},{component:this.processExitCodeBox,title:this.ProcessExitCodeText},{component:this.commandTextBox,title:this.CommandLabelString,actions:[this.openButton,this.parseButton]}],{horizontal:!1,componentWidth:420}).component();this.typeDropdown.onValueChanged((t=>{switch(t.selected){case c.TSQLScript:this.runAsDropdown.value="",this.runAsDropdown.values=[""],this.runAsDropdown.enabled=!1,this.databaseDropdown.enabled=!0,this.databaseDropdown.values=e,this.databaseDropdown.value=e[0],this.processExitCodeBox.value="",this.processExitCodeBox.enabled=!1;break;case c.Powershell:this.runAsDropdown.value=c.AgentServiceAccount,this.runAsDropdown.values=[this.runAsDropdown.value],this.runAsDropdown.enabled=!0,this.databaseDropdown.enabled=!1,this.databaseDropdown.values=[""],this.databaseDropdown.value="",this.processExitCodeBox.value="",this.processExitCodeBox.enabled=!1;break;case c.CmdExec:this.databaseDropdown.enabled=!1,this.databaseDropdown.values=[""],this.databaseDropdown.value="",this.runAsDropdown.value=c.AgentServiceAccount,this.runAsDropdown.values=[this.runAsDropdown.value],this.runAsDropdown.enabled=!0,this.processExitCodeBox.enabled=!0,this.processExitCodeBox.value="0"}}));let a=o.modelBuilder.loadingComponent().withItem(i).component();a.loading=!1,await o.initializeModel(a),this.isEdit&&(this.nameTextBox.value=this.model.stepName,this.typeDropdown.value=n.JobStepData.convertToSubSystemDisplayName(this.model.subSystem),this.databaseDropdown.value=this.model.databaseName,this.commandTextBox.value=this.model.command)}))}createAdvancedTab(){this.advancedTab.registerContent((async e=>{this.successActionDropdown=e.modelBuilder.dropDown().withProps({width:"100%",value:c.NextStep,values:[c.NextStep,c.QuitJobReportingSuccess,c.QuitJobReportingFailure]}).component();let t=this.createRetryCounters(e);this.failureActionDropdown=e.modelBuilder.dropDown().withProps({value:c.QuitJobReportingFailure,values:[c.QuitJobReportingFailure,c.NextStep,c.QuitJobReportingSuccess]}).component();let o=this.createTSQLOptions(e);this.logToTableCheckbox=e.modelBuilder.checkBox().withProps({label:this.LogToTableLabel}).component();let i=e.modelBuilder.checkBox().withProps({label:this.AppendExistingTableEntryLabel}).component();i.enabled=!1,this.logToTableCheckbox.onChanged((e=>{i.enabled=e}));let a=e.modelBuilder.groupContainer().withItems([i]).component(),s=e.modelBuilder.flexContainer().withLayout({flexFlow:"row",justifyContent:"space-between",width:300}).withItems([this.logToTableCheckbox]).component();this.logStepOutputHistoryCheckbox=e.modelBuilder.checkBox().withProps({label:this.IncludeStepOutputHistoryLabel}).component(),this.userInputBox=e.modelBuilder.inputBox().withProps({inputType:"text",width:"100%"}).component();let l=e.modelBuilder.formContainer().withFormItems([{component:this.successActionDropdown,title:this.SuccessActionLabel},{component:t,title:""},{component:this.failureActionDropdown,title:this.FailureActionLabel},{component:o,title:c.TSQLScript},{component:s,title:""},{component:a,title:"                            "},{component:this.logStepOutputHistoryCheckbox,title:""},{component:this.userInputBox,title:this.RunAsUserLabel}],{componentWidth:400}).component(),r=e.modelBuilder.loadingComponent().withItem(l).component();r.loading=!1,await e.initializeModel(r),this.isEdit&&(this.successActionDropdown.value=n.JobStepData.convertToCompletionActionDisplayName(this.model.successAction),this.retryAttemptsBox.value=this.model.retryAttempts.toString(),this.retryIntervalBox.value=this.model.retryInterval.toString(),this.failureActionDropdown.value=n.JobStepData.convertToCompletionActionDisplayName(this.model.failureAction),this.outputFileNameBox.value=this.model.outputFileName,this.appendToExistingFileCheckbox.checked=this.model.appendToLogFile,this.logToTableCheckbox.checked=this.model.appendLogToTable,this.logStepOutputHistoryCheckbox.checked=this.model.appendToStepHist,this.userInputBox.value=this.model.databaseUserName)}))}createRetryCounters(e){this.retryAttemptsBox=e.modelBuilder.inputBox().withValidation((e=>Number(e.value)>=0)).withProps({inputType:"number",width:"100%",value:"0"}).component(),this.retryIntervalBox=e.modelBuilder.inputBox().withValidation((e=>Number(e.value)>=0)).withProps({inputType:"number",width:"100%",value:"0"}).component();let t=e.modelBuilder.formContainer().withFormItems([{component:this.retryAttemptsBox,title:this.RetryAttemptsLabel}],{horizontal:!1,componentWidth:"100%"}).component(),o=e.modelBuilder.formContainer().withFormItems([{component:this.retryIntervalBox,title:this.RetryIntervalLabel}],{horizontal:!1}).component();return e.modelBuilder.flexContainer().withLayout({flexFlow:"row"}).withItems([t,o]).component()}openFileBrowserDialog(){let e=this.FileBrowserDialogTitle+`${this.server}`;this.fileBrowserDialog=a.window.createModelViewDialog(e);let t=a.window.createTab("File Browser");this.fileBrowserDialog.content=[t],t.registerContent((async e=>{this.fileBrowserTree=e.modelBuilder.fileBrowserTree().withProps({ownerUri:this.ownerUri,width:420,height:700}).component(),this.selectedPathTextBox=e.modelBuilder.inputBox().withProps({inputType:"text"}).component(),this.fileBrowserTree.onDidChange((e=>{this.selectedPathTextBox.value=e.fullPath,this.fileBrowserNameBox.value=e.isFile?h.win32.basename(e.fullPath):""})),this.fileTypeDropdown=e.modelBuilder.dropDown().withProps({value:this.AllFilesLabelString,values:[this.AllFilesLabelString]}).component(),this.fileBrowserNameBox=e.modelBuilder.inputBox().withProps({}).component();let t=e.modelBuilder.formContainer().withFormItems([{component:this.fileBrowserTree,title:""},{component:this.selectedPathTextBox,title:this.SelectedPathLabelString},{component:this.fileTypeDropdown,title:this.FilesOfTypeLabelString},{component:this.fileBrowserNameBox,title:this.FileNameLabelString}]).component();e.initializeModel(t)})),this.fileBrowserDialog.okButton.onClick((()=>{this.outputFileNameBox.value=h.join(h.dirname(this.selectedPathTextBox.value),this.fileBrowserNameBox.value)})),this.fileBrowserDialog.okButton.label=this.OkButtonText,this.fileBrowserDialog.cancelButton.label=this.CancelButtonText,a.window.openDialog(this.fileBrowserDialog)}createTSQLOptions(e){this.outputFileBrowserButton=e.modelBuilder.button().withProps({width:"20px",label:"...",secondary:!0}).component(),this.outputFileBrowserButton.onDidClick((()=>this.openFileBrowserDialog())),this.outputFileNameBox=e.modelBuilder.inputBox().withProps({width:250,inputType:"text"}).component();let t=e.modelBuilder.flexContainer().withLayout({flexFlow:"row",textAlign:"right",width:"100%"}).withItems([this.outputFileBrowserButton],{flex:"1 1 50%"}).component(),o=e.modelBuilder.flexContainer().withLayout({flexFlow:"row",width:350}).withItems([this.outputFileNameBox,t],{flex:"1 1 50%"}).component();return this.appendToExistingFileCheckbox=e.modelBuilder.checkBox().withProps({label:this.AppendOutputToFileLabel}).component(),this.appendToExistingFileCheckbox.enabled=!1,this.outputFileNameBox.onTextChanged((e=>{this.appendToExistingFileCheckbox.enabled=""!==e})),e.modelBuilder.formContainer().withFormItems([{component:o,title:this.OutputFileNameLabel},{component:this.appendToExistingFileCheckbox,title:""}],{horizontal:!1,componentWidth:200}).component()}async updateModel(){this.model.stepName=this.nameTextBox.value,this.model.stepName&&0!==this.model.stepName.length?(this.model.jobName=this.jobName,this.model.id=this.stepId,this.model.server=this.server,this.model.subSystem=n.JobStepData.convertToAgentSubSystem(this.typeDropdown.value),this.model.databaseName=this.databaseDropdown.value,this.model.script=this.commandTextBox.value,this.model.successAction=n.JobStepData.convertToStepCompletionAction(this.successActionDropdown.value),this.model.retryAttempts=this.retryAttemptsBox.value?+this.retryAttemptsBox.value:0,this.model.retryInterval=+this.retryIntervalBox.value?+this.retryIntervalBox.value:0,this.model.failureAction=n.JobStepData.convertToStepCompletionAction(this.failureActionDropdown.value),this.model.outputFileName=this.outputFileNameBox.value,this.model.appendToLogFile=this.appendToExistingFileCheckbox.checked,this.model.command=this.commandTextBox.value?this.commandTextBox.value:"",this.model.commandExecutionSuccessCode=this.processExitCodeBox.value?+this.processExitCodeBox.value:0):this.dialog.message=this.dialog.message={text:this.BlankStepNameErrorText}}async initializeDialog(){let e=await s.AgentUtils.getDatabases(this.ownerUri),t=await s.AgentUtils.getQueryProvider();this.initializeUIComponents(),this.createGeneralTab(e,t),this.createAdvancedTab(),this.dialog.registerCloseValidator((()=>{this.updateModel();let e=this.model.validate();return e.valid||console.error(e.errorMessages.join(",")),e.valid}))}}t.JobStepDialog=c,c.NewDialogTitle=d(30,null),c.EditDialogTitle=d(31,null),c.TSQLScript=d(32,null),c.Powershell=d(33,null),c.CmdExec=d(34,null),c.ReplicationDistributor=d(35,null),c.ReplicationMerge=d(36,null),c.ReplicationQueueReader=d(37,null),c.ReplicationSnapshot=d(38,null),c.ReplicationTransactionLogReader=d(39,null),c.AnalysisServicesCommand=d(40,null),c.AnalysisServicesQuery=d(41,null),c.ServicesPackage=d(42,null),c.AgentServiceAccount=d(43,null),c.NextStep=d(44,null),c.QuitJobReportingSuccess=d(45,null),c.QuitJobReportingFailure=d(46,null)},732:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NotebookDialog=t.NotebookDialogOptions=void 0;const i=o(403),a=o(622),n=o(331),s=o(453),l=o(992),r=o(402),h=o(250),d=i.loadMessageBundle(o(622).join(__dirname,"dialogs/notebookDialog.ts")),c=d(0,null),u=d(1,null),p=d(2,null),m=d(3,null),g=d(4,null),b=d(5,null),w=d(6,null),x=d(7,null),S=d(8,null),T=d(9,null),y=d(10,null),B=d(11,null),D=d(12,null),v=d(13,null),C=d(14,null);t.NotebookDialogOptions=class{};class k extends l.AgentDialog{constructor(e,t){super(e,new h.NotebookData(e,t),t.notebookInfo?u:c),this.isEdit=!1,this.schedules=this.model.jobSchedules?this.model.jobSchedules:[],this.isEdit=!!t.notebookInfo,this.dialogName=this.isEdit?"EditNotebookJobDialogOpened":"NewNotebookJobDialogOpened"}async initializeDialog(){this.generalTab=n.window.createTab(p),this.initializeGeneralTab(),this.dialog.content=[this.generalTab],this.dialog.registerCloseValidator((async()=>{this.updateModel();let e=await this.model.validate();return e.valid||(this.dialog.message={text:e.errorMessages[0]},console.error(e.errorMessages.join(","))),e.valid}))}initializeGeneralTab(){this.generalTab.registerContent((async e=>{this.templateFilePathBox=e.modelBuilder.inputBox().withProps({width:400,inputType:"text"}).component(),this.openTemplateFileButton=e.modelBuilder.button().withProps({label:"...",title:"...",width:"20px",isFile:!0,fileType:".ipynb",secondary:!0}).component(),this.openTemplateFileButton.onDidClick((e=>{if(e&&(this.templateFilePathBox.value=e.filePath,!this.isEdit)){let t=a.basename(e.filePath).split(".").slice(0,-1).join(".");this.nameTextBox.value=t}}));let t=e.modelBuilder.flexContainer().withLayout({flexFlow:"row",textAlign:"right",width:20}).withItems([this.openTemplateFileButton],{flex:"1 1 80%"}).component(),o=e.modelBuilder.flexContainer().withLayout({flexFlow:"row",width:"100%"}).withItems([this.templateFilePathBox,t],{flex:"1 1 50%"}).component();this.targetDatabaseDropDown=e.modelBuilder.dropDown().component(),this.executeDatabaseDropDown=e.modelBuilder.dropDown().component();let i=await r.AgentUtils.getDatabases(this.ownerUri);i.unshift(x),this.targetDatabaseDropDown=e.modelBuilder.dropDown().withProps({value:i[0],values:i}).component(),this.descriptionTextBox=e.modelBuilder.inputBox().withProps({multiline:!0,height:50}).component(),this.executeDatabaseDropDown=e.modelBuilder.dropDown().withProps({value:i[0],values:i}).component(),this.targetDatabaseDropDown.required=!0,this.executeDatabaseDropDown.required=!0,this.descriptionTextBox=e.modelBuilder.inputBox().withProps({multiline:!0,height:50}).component(),this.nameTextBox=e.modelBuilder.inputBox().component(),this.nameTextBox.required=!0,this.nameTextBox.onTextChanged((()=>{this.nameTextBox.value&&this.nameTextBox.value.length>0&&(this.dialog.message=null,this.model.name=this.nameTextBox.value)})),this.ownerTextBox=e.modelBuilder.inputBox().component(),this.schedulesTable=e.modelBuilder.table().withProps({columns:[s.PickScheduleDialog.SchedulesIDText,s.PickScheduleDialog.ScheduleNameLabelText,s.PickScheduleDialog.ScheduleDescription],data:[],height:50,width:420}).component(),this.pickScheduleButton=e.modelBuilder.button().withProps({label:D,width:110,secondary:!0}).component(),this.removeScheduleButton=e.modelBuilder.button().withProps({label:v,width:110,secondary:!0}).component(),this.pickScheduleButton.onDidClick((()=>{let e=new s.PickScheduleDialog(this.model.ownerUri,this.model.name);e.onSuccess((e=>{let t=e.selectedSchedule;t&&(this.schedules.find((e=>e.name===t.name))||(t.jobName=this.model.name?this.model.name:this.nameTextBox.value,this.schedules.push(t)),this.populateScheduleTable())})),e.showDialog()})),this.removeScheduleButton.onDidClick((()=>{if(1===this.schedulesTable.selectedRows.length){let e=this.schedulesTable.selectedRows[0],t=this.schedulesTable.data[e][1];for(let e=0;e<this.schedules.length;e++)this.schedules[e].name===t&&this.schedules.splice(e,1);this.populateScheduleTable()}}));let n=e.modelBuilder.formContainer().withFormItems([{components:[{component:o,title:g,layout:{info:d(15,null)}},{component:this.targetDatabaseDropDown,title:b,layout:{info:d(16,null)}},{component:this.executeDatabaseDropDown,title:w,layout:{info:d(17,null)}}],title:m},{components:[{component:this.nameTextBox,title:T},{component:this.ownerTextBox,title:y},{component:this.schedulesTable,title:B,actions:[this.pickScheduleButton,this.removeScheduleButton]},{component:this.descriptionTextBox,title:C}],title:S}]).withLayout({width:"100%"}).component();await e.initializeModel(n),this.nameTextBox.value=this.model.name,this.ownerTextBox.value=this.model.owner,this.templateFilePathBox.value=this.model.templatePath,this.isEdit?(this.templateFilePathBox.placeHolder=this.model.targetDatabase+"\\"+this.model.name,this.targetDatabaseDropDown.value=this.model.targetDatabase,this.executeDatabaseDropDown.value=this.model.executeDatabase,this.targetDatabaseDropDown.enabled=!1,this.schedules=this.model.jobSchedules):this.templateFilePathBox.required=!0,this.descriptionTextBox.value=this.model.description,this.openTemplateFileButton.onDidClick((e=>{})),this.populateScheduleTable()}))}populateScheduleTable(){let e=this.convertSchedulesToData(this.schedules);this.schedulesTable.data=e,this.schedulesTable.height=100}convertSchedulesToData(e){let t=[];return e.forEach((e=>{let o=[];o.push(e.id),o.push(e.name),o.push(e.description),t.push(o)})),t}async updateModel(){this.model.name=this.nameTextBox.value,this.model.owner=this.ownerTextBox.value,this.model.description=this.descriptionTextBox.value,this.model.templatePath=this.templateFilePathBox.value,this.model.targetDatabase=this.targetDatabaseDropDown.value,this.model.executeDatabase=this.executeDatabaseDropDown.value,this.model.jobSchedules||(this.model.jobSchedules=[]),this.model.alerts=[],this.model.jobSteps=[],this.model.jobSchedules=this.schedules,this.model.category="[Uncategorized (Local)]",this.model.categoryId=0,this.model.eventLogLevel=0}}t.NotebookDialog=k},290:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OperatorDialog=void 0;const i=o(331),a=o(523),n=o(403),s=o(992),l=n.loadMessageBundle(o(622).join(__dirname,"dialogs/operatorDialog.ts"));class r extends s.AgentDialog{constructor(e,t){super(e,new a.OperatorData(e,t),t?r.EditDialogTitle:r.CreateDialogTitle),this.NewOperatorDialog="NewOperatorDialogOpened",this.EditOperatorDialog="EditOperatorDialogOpened",this.isEdit=!1,this.isEdit=!!t,this.dialogName=this.isEdit?this.EditOperatorDialog:this.NewOperatorDialog}async initializeDialog(e){this.generalTab=i.window.createTab(r.GeneralTabText),this.notificationsTab=i.window.createTab(r.NotificationsTabText),this.initializeGeneralTab(),this.initializeNotificationTab(),this.dialog.content=[this.generalTab,this.notificationsTab]}initializeGeneralTab(){this.generalTab.registerContent((async e=>{this.nameTextBox=e.modelBuilder.inputBox().withProps({ariaLabel:r.NameLabel,placeHolder:r.NameLabel}).component(),this.nameTextBox.value=this.model.name,this.emailNameTextBox=e.modelBuilder.inputBox().withProps({ariaLabel:r.EmailNameTextLabel,placeHolder:r.EmailNameTextLabel}).component(),this.emailNameTextBox.value=this.model.emailAddress,this.pagerEmailNameTextBox=e.modelBuilder.inputBox().withProps({ariaLabel:r.PagerEmailNameTextLabel,placeHolder:r.PagerEmailNameTextLabel}).component(),this.pagerEmailNameTextBox.value=this.model.pagerAddress,this.enabledCheckBox=e.modelBuilder.checkBox().withProps({label:r.EnabledCheckboxLabel}).component(),this.enabledCheckBox.checked=this.model.enabled,this.pagerMondayCheckBox=e.modelBuilder.checkBox().withProps({label:r.PagerMondayCheckBoxLabel}).component(),this.pagerMondayCheckBox.onChanged((()=>{this.pagerMondayCheckBox.checked?(this.weekdayPagerStartTimeInput.enabled=!0,this.weekdayPagerEndTimeInput.enabled=!0):this.pagerTuesdayCheckBox.checked||this.pagerWednesdayCheckBox.checked||this.pagerThursdayCheckBox.checked||this.pagerFridayCheckBox.checked||(this.weekdayPagerStartTimeInput.enabled=!1,this.weekdayPagerEndTimeInput.enabled=!1)})),this.pagerTuesdayCheckBox=e.modelBuilder.checkBox().withProps({label:r.PagerTuesdayCheckBoxLabel}).component(),this.pagerTuesdayCheckBox.onChanged((()=>{this.pagerTuesdayCheckBox.checked?(this.weekdayPagerStartTimeInput.enabled=!0,this.weekdayPagerEndTimeInput.enabled=!0):this.pagerMondayCheckBox.checked||this.pagerWednesdayCheckBox.checked||this.pagerThursdayCheckBox.checked||this.pagerFridayCheckBox.checked||(this.weekdayPagerStartTimeInput.enabled=!1,this.weekdayPagerEndTimeInput.enabled=!1)})),this.pagerWednesdayCheckBox=e.modelBuilder.checkBox().withProps({label:r.PagerWednesdayCheckBoxLabel}).component(),this.pagerWednesdayCheckBox.onChanged((()=>{this.pagerWednesdayCheckBox.checked?(this.weekdayPagerStartTimeInput.enabled=!0,this.weekdayPagerEndTimeInput.enabled=!0):this.pagerMondayCheckBox.checked||this.pagerTuesdayCheckBox.checked||this.pagerThursdayCheckBox.checked||this.pagerFridayCheckBox.checked||(this.weekdayPagerStartTimeInput.enabled=!1,this.weekdayPagerEndTimeInput.enabled=!1)})),this.pagerThursdayCheckBox=e.modelBuilder.checkBox().withProps({label:r.PagerThursdayCheckBoxLabel}).component(),this.pagerThursdayCheckBox.onChanged((()=>{this.pagerThursdayCheckBox.checked?(this.weekdayPagerStartTimeInput.enabled=!0,this.weekdayPagerEndTimeInput.enabled=!0):this.pagerMondayCheckBox.checked||this.pagerWednesdayCheckBox.checked||this.pagerTuesdayCheckBox.checked||this.pagerFridayCheckBox.checked||(this.weekdayPagerStartTimeInput.enabled=!1,this.weekdayPagerEndTimeInput.enabled=!1)})),this.weekdayPagerStartTimeInput=e.modelBuilder.inputBox().withProps({inputType:"time",placeHolder:"08:00:00"}).component(),this.weekdayPagerStartTimeInput.enabled=!1;let t=e.modelBuilder.formContainer().withFormItems([{component:this.weekdayPagerStartTimeInput,title:r.WorkdayBeginLabel}]).component();this.weekdayPagerEndTimeInput=e.modelBuilder.inputBox().withProps({inputType:"time",placeHolder:"06:00:00"}).component(),this.weekdayPagerEndTimeInput.enabled=!1;let o=e.modelBuilder.formContainer().withFormItems([{component:this.weekdayPagerEndTimeInput,title:r.WorkdayEndLabel}]).component();this.pagerFridayCheckBox=e.modelBuilder.checkBox().withProps({label:r.PagerFridayCheckBoxLabel}).component(),this.pagerFridayCheckBox.onChanged((()=>{this.pagerFridayCheckBox.checked?(this.weekdayPagerStartTimeInput.enabled=!0,this.weekdayPagerEndTimeInput.enabled=!0):this.pagerMondayCheckBox.checked||this.pagerWednesdayCheckBox.checked||this.pagerThursdayCheckBox.checked||this.pagerTuesdayCheckBox.checked||(this.weekdayPagerStartTimeInput.enabled=!1,this.weekdayPagerEndTimeInput.enabled=!1)}));let i=e.modelBuilder.flexContainer().withLayout({flexFlow:"row",alignItems:"baseline",width:"100%"}).withItems([this.pagerFridayCheckBox,t,o]).component();this.pagerSaturdayCheckBox=e.modelBuilder.checkBox().withProps({label:r.PagerSaturdayCheckBoxLabel}).component(),this.pagerSaturdayCheckBox.onChanged((()=>{this.pagerSaturdayCheckBox.checked?(this.saturdayPagerStartTimeInput.enabled=!0,this.saturdayPagerEndTimeInput.enabled=!0):(this.saturdayPagerStartTimeInput.enabled=!1,this.saturdayPagerEndTimeInput.enabled=!1)})),this.saturdayPagerStartTimeInput=e.modelBuilder.inputBox().withProps({inputType:"time",placeHolder:"08:00:00"}).component(),this.saturdayPagerStartTimeInput.enabled=!1;let a=e.modelBuilder.formContainer().withFormItems([{component:this.saturdayPagerStartTimeInput,title:r.WorkdayBeginLabel}]).component();this.saturdayPagerEndTimeInput=e.modelBuilder.inputBox().withProps({inputType:"time",placeHolder:"06:00:00"}).component(),this.saturdayPagerEndTimeInput.enabled=!1;let n=e.modelBuilder.formContainer().withFormItems([{component:this.saturdayPagerEndTimeInput,title:r.WorkdayEndLabel}]).component(),s=e.modelBuilder.flexContainer().withLayout({flexFlow:"row",alignItems:"baseline"}).withItems([this.pagerSaturdayCheckBox,a,n]).component();this.pagerSundayCheckBox=e.modelBuilder.checkBox().withProps({label:r.PagerSundayCheckBoxLabel}).component(),this.pagerSundayCheckBox.onChanged((()=>{this.pagerSundayCheckBox.checked?(this.sundayPagerStartTimeInput.enabled=!0,this.sundayPagerEndTimeInput.enabled=!0):(this.sundayPagerStartTimeInput.enabled=!1,this.sundayPagerEndTimeInput.enabled=!1)})),this.sundayPagerStartTimeInput=e.modelBuilder.inputBox().withProps({inputType:"time",placeHolder:"08:00:00"}).component(),this.sundayPagerStartTimeInput.enabled=!1;let l=e.modelBuilder.formContainer().withFormItems([{component:this.sundayPagerStartTimeInput,title:r.WorkdayBeginLabel}]).component();this.sundayPagerEndTimeInput=e.modelBuilder.inputBox().withProps({inputType:"time",placeHolder:"06:00:00"}).component(),this.sundayPagerEndTimeInput.enabled=!1;let h=e.modelBuilder.formContainer().withFormItems([{component:this.sundayPagerEndTimeInput,title:r.WorkdayEndLabel}]).component(),d=e.modelBuilder.flexContainer().withLayout({flexFlow:"row",alignItems:"baseline"}).withItems([this.pagerSundayCheckBox,l,h]).component(),c=e.modelBuilder.formContainer().withFormItems([{component:this.nameTextBox,title:r.NameLabel},{component:this.enabledCheckBox,title:""},{component:this.emailNameTextBox,title:r.EmailNameTextLabel},{component:this.pagerEmailNameTextBox,title:r.PagerEmailNameTextLabel},{components:[{component:this.pagerMondayCheckBox,title:""},{component:this.pagerTuesdayCheckBox,title:""},{component:this.pagerWednesdayCheckBox,title:""},{component:this.pagerThursdayCheckBox,title:""}],title:r.PagerDutyScheduleLabel},{component:i,title:""},{component:e.modelBuilder.separator().component(),title:""},{component:s,title:""},{component:e.modelBuilder.separator().component(),title:""},{component:d,title:""}]).withLayout({width:"100%"}).component();await e.initializeModel(c)}))}initializeNotificationTab(){this.notificationsTab.registerContent((async e=>{let t=e.modelBuilder.text().withProps({value:"Feature Preview"}).component();this.alertsTable=e.modelBuilder.table().withProps({columns:[r.AlertNameColumnLabel,r.AlertEmailColumnLabel,r.AlertPagerColumnLabel],data:[],height:500}).component();let o=e.modelBuilder.formContainer().withFormItems([{component:t,title:""},{component:this.alertsTable,title:r.AlertsTableLabel}]).withLayout({width:"100%"}).component();await e.initializeModel(o)}))}async updateModel(){this.model.name=this.nameTextBox.value,this.model.enabled=this.enabledCheckBox.checked,this.model.emailAddress=this.emailNameTextBox.value,this.model.pagerAddress=this.pagerEmailNameTextBox.value,this.model.weekdayPagerStartTime=this.weekdayPagerStartTimeInput.value,this.model.weekdayPagerEndTime=this.weekdayPagerEndTimeInput.value,this.model.saturdayPagerStartTime=this.saturdayPagerStartTimeInput.value,this.model.saturdayPagerEndTime=this.saturdayPagerEndTimeInput.value,this.model.sundayPagerStartTime=this.sundayPagerStartTimeInput.value,this.model.sundayPagerEndTime=this.sundayPagerEndTimeInput.value}}t.OperatorDialog=r,r.CreateDialogTitle=l(0,null),r.EditDialogTitle=l(1,null),r.GeneralTabText=l(2,null),r.NotificationsTabText=l(3,null),r.NameLabel=l(4,null),r.EnabledCheckboxLabel=l(5,null),r.EmailNameTextLabel=l(6,null),r.PagerEmailNameTextLabel=l(7,null),r.PagerMondayCheckBoxLabel=l(8,null),r.PagerTuesdayCheckBoxLabel=l(9,null),r.PagerWednesdayCheckBoxLabel=l(10,null),r.PagerThursdayCheckBoxLabel=l(11,null),r.PagerFridayCheckBoxLabel=l(12,null),r.PagerSaturdayCheckBoxLabel=l(13,null),r.PagerSundayCheckBoxLabel=l(14,null),r.WorkdayBeginLabel=l(15,null),r.WorkdayEndLabel=l(16,null),r.PagerDutyScheduleLabel=l(17,null),r.AlertsTableLabel=l(18,null),r.AlertNameColumnLabel=l(19,null),r.AlertEmailColumnLabel=l(20,null),r.AlertPagerColumnLabel=l(21,null)},453:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PickScheduleDialog=void 0;const i=o(403),a=o(331),n=o(549),s=o(293),l=i.loadMessageBundle(o(622).join(__dirname,"dialogs/pickScheduleDialog.ts"));class r{constructor(e,t){this.DialogTitle=l(0,null),this.OkButtonText=l(1,null),this.CancelButtonText=l(2,null),this.SchedulesLabelText=l(3,null),this._onSuccess=new n.EventEmitter,this.onSuccess=this._onSuccess.event,this.model=new s.PickScheduleData(e,t)}async showDialog(){this.model.initialize().then((e=>{if(this.loadingComponent&&(this.loadingComponent.loading=!1),this.model.schedules){let e=[];for(let t=0;t<this.model.schedules.length;++t){let o=this.model.schedules[t];e[t]=[o.id,o.name,o.description]}this.schedulesTable.data=e}})),this.dialog=a.window.createModelViewDialog(this.DialogTitle),this.initializeContent(),this.dialog.okButton.onClick((async()=>await this.execute())),this.dialog.cancelButton.onClick((async()=>await this.cancel())),this.dialog.okButton.label=this.OkButtonText,this.dialog.cancelButton.label=this.CancelButtonText,a.window.openDialog(this.dialog)}initializeContent(){this.dialog.registerContent((async e=>{this.schedulesTable=e.modelBuilder.table().withProps({columns:[r.SchedulesIDText,r.ScheduleNameLabelText,r.ScheduleDescription],data:[],height:750,width:430}).component();let t=e.modelBuilder.formContainer().withFormItems([{component:this.schedulesTable,title:this.SchedulesLabelText}]).withLayout({width:"100%"}).component();this.loadingComponent=e.modelBuilder.loadingComponent().withItem(t).component(),this.loadingComponent.loading=!0,this.model.initialize().then((e=>{if(this.loadingComponent.loading=!1,this.model.schedules){let e=[];for(let t=0;t<this.model.schedules.length;++t){let o=this.model.schedules[t];e[t]=[o.id,o.name,o.description]}this.schedulesTable.data=e}})),this.loadingComponent.loading=!this.model.isInitialized(),await e.initializeModel(this.loadingComponent)}))}async execute(){this.updateModel(),await this.model.save(),this._onSuccess.fire(this.model)}async cancel(){}updateModel(){let e=this.schedulesTable.selectedRows;if(e&&e.length>0){let t=e[0];this.model.selectedSchedule=this.model.schedules[t]}}}t.PickScheduleDialog=r,r.ScheduleNameLabelText=l(4,null),r.SchedulesIDText=l(5,null),r.ScheduleDescription=l(6,null)},36:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyDialog=void 0;const i=o(403),a=o(331),n=o(992),s=o(157),l=i.loadMessageBundle(o(622).join(__dirname,"dialogs/proxyDialog.ts"));class r extends n.AgentDialog{constructor(e,t,o){super(e,new s.ProxyData(e,t),t?r.EditDialogTitle:r.CreateDialogTitle),this.NewProxyDialog="NewProxyDialogOpened",this.EditProxyDialog="EditProxyDialogOpened",this.isEdit=!1,this.credentials=o,this.isEdit=!!t,this.dialogName=this.isEdit?this.EditProxyDialog:this.NewProxyDialog}async initializeDialog(e){this.generalTab=a.window.createTab(r.GeneralTabText),this.initializeGeneralTab(),this.dialog.content=[this.generalTab]}initializeGeneralTab(){this.generalTab.registerContent((async e=>{this.proxyNameTextBox=e.modelBuilder.inputBox().withProps({width:420,ariaLabel:r.ProxyNameTextBoxLabel,placeHolder:r.ProxyNameTextBoxLabel}).component(),this.credentialNameDropDown=e.modelBuilder.dropDown().withProps({width:432,value:"",editable:!0,values:this.credentials.length>0?this.credentials.map((e=>e.name)):[""]}).component(),this.descriptionTextBox=e.modelBuilder.inputBox().withProps({width:420,multiline:!0,height:300,ariaLabel:r.DescriptionTextBoxLabel,placeHolder:r.DescriptionTextBoxLabel}).component(),this.subsystemCheckBox=e.modelBuilder.checkBox().withProps({label:r.SubsystemLabel}).component(),this.subsystemCheckBox.onChanged((()=>{this.subsystemCheckBox.checked?(this.operatingSystemCheckBox.checked=!0,this.replicationSnapshotCheckBox.checked=!0,this.replicationTransactionLogCheckBox.checked=!0,this.replicationDistributorCheckBox.checked=!0,this.replicationMergeCheckbox.checked=!0,this.replicationQueueReaderCheckbox.checked=!0,this.sqlQueryCheckBox.checked=!0,this.sqlCommandCheckBox.checked=!0,this.sqlIntegrationServicesPackageCheckbox.checked=!0,this.powershellCheckBox.checked=!0):(this.operatingSystemCheckBox.checked=!1,this.replicationSnapshotCheckBox.checked=!1,this.replicationTransactionLogCheckBox.checked=!1,this.replicationDistributorCheckBox.checked=!1,this.replicationMergeCheckbox.checked=!1,this.replicationQueueReaderCheckbox.checked=!1,this.sqlQueryCheckBox.checked=!1,this.sqlCommandCheckBox.checked=!1,this.sqlIntegrationServicesPackageCheckbox.checked=!1,this.powershellCheckBox.checked=!1)})),this.operatingSystemCheckBox=e.modelBuilder.checkBox().withProps({label:r.OperatingSystemLabel}).component(),this.replicationSnapshotCheckBox=e.modelBuilder.checkBox().withProps({label:r.ReplicationSnapshotLabel}).component(),this.replicationTransactionLogCheckBox=e.modelBuilder.checkBox().withProps({label:r.ReplicationTransactionLogLabel}).component(),this.replicationDistributorCheckBox=e.modelBuilder.checkBox().withProps({label:r.ReplicationDistributorLabel}).component(),this.replicationMergeCheckbox=e.modelBuilder.checkBox().withProps({label:r.ReplicationMergeLabel}).component(),this.replicationQueueReaderCheckbox=e.modelBuilder.checkBox().withProps({label:r.ReplicationQueueReaderLabel}).component(),this.sqlQueryCheckBox=e.modelBuilder.checkBox().withProps({label:r.SSASQueryLabel}).component(),this.sqlCommandCheckBox=e.modelBuilder.checkBox().withProps({label:r.SSASCommandLabel}).component(),this.sqlIntegrationServicesPackageCheckbox=e.modelBuilder.checkBox().withProps({label:r.SSISPackageLabel}).component(),this.powershellCheckBox=e.modelBuilder.checkBox().withProps({label:r.PowerShellLabel}).component(),e.modelBuilder.groupContainer().withItems([this.operatingSystemCheckBox,this.replicationSnapshotCheckBox,this.replicationTransactionLogCheckBox,this.replicationDistributorCheckBox,this.replicationMergeCheckbox,this.replicationQueueReaderCheckbox,this.sqlQueryCheckBox,this.sqlCommandCheckBox,this.sqlIntegrationServicesPackageCheckbox,this.powershellCheckBox]).component();let t=e.modelBuilder.formContainer().withFormItems([{component:this.proxyNameTextBox,title:r.ProxyNameTextBoxLabel},{component:this.credentialNameDropDown,title:r.CredentialNameTextBoxLabel},{component:this.descriptionTextBox,title:r.DescriptionTextBoxLabel}]).withLayout({width:420}).component();await e.initializeModel(t),this.proxyNameTextBox.value=this.model.accountName,this.credentialNameDropDown.value=this.model.credentialName,this.descriptionTextBox.value=this.model.description}))}async updateModel(){this.model.accountName=this.proxyNameTextBox.value,this.model.credentialName=this.credentialNameDropDown.value,this.model.credentialId=this.credentials.find((e=>e.name===this.model.credentialName)).id,this.model.credentialIdentity=this.credentials.find((e=>e.name===this.model.credentialName)).identity,this.model.description=this.descriptionTextBox.value}}t.ProxyDialog=r,r.CreateDialogTitle=l(0,null),r.EditDialogTitle=l(1,null),r.GeneralTabText=l(2,null),r.ProxyNameTextBoxLabel=l(3,null),r.CredentialNameTextBoxLabel=l(4,null),r.DescriptionTextBoxLabel=l(5,null),r.SubsystemLabel=l(6,null),r.OperatingSystemLabel=l(7,null),r.ReplicationSnapshotLabel=l(8,null),r.ReplicationTransactionLogLabel=l(9,null),r.ReplicationDistributorLabel=l(10,null),r.ReplicationMergeLabel=l(11,null),r.ReplicationQueueReaderLabel=l(12,null),r.SSASQueryLabel=l(13,null),r.SSASCommandLabel=l(14,null),r.SSISPackageLabel=l(15,null),r.PowerShellLabel=l(16,null)},912:(e,t)=>{var o;Object.defineProperty(t,"__esModule",{value:!0}),t.AgentDialogMode=void 0,(o=t.AgentDialogMode||(t.AgentDialogMode={}))[o.CREATE=1]="CREATE",o[o.EDIT=2]="EDIT",o[o.VIEW=3]="VIEW"},167:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MainController=void 0;const i=o(403),a=o(331),n=o(549),s=o(747),l=o(87),r=o(622),h=o(104),d=o(275),c=o(290),u=o(36),p=o(634),m=o(453),g=o(365),b=o(402),w=o(732),x=i.loadMessageBundle(o(622).join(__dirname,"mainController.ts"));t.MainController=class{constructor(e){this.notebookTemplateMap=new Map,this._context=e}static showNotYetImplemented(){n.window.showInformationMessage(x(0,null))}activate(){n.commands.registerCommand("agent.openJobDialog",(async(e,t)=>{(!this.jobDialog||this.jobDialog&&!this.jobDialog.isOpen)&&(this.jobDialog=new d.JobDialog(e,t)),this.jobDialog.isOpen||(this.jobDialog.dialogName?await this.jobDialog.openDialog(this.jobDialog.dialogName):await this.jobDialog.openDialog())})),n.commands.registerCommand("agent.openNewStepDialog",((e,t,o,i)=>{b.AgentUtils.getAgentService().then((async a=>{let n=new g.JobData(e,o,a),s=new p.JobStepDialog(e,t,n,i,!1);s.dialogName?await s.openDialog(s.dialogName):await s.openDialog()}))})),n.commands.registerCommand("agent.openPickScheduleDialog",(async(e,t)=>{let o=new m.PickScheduleDialog(e,t);await o.showDialog()})),n.commands.registerCommand("agent.openAlertDialog",(async(e,t,o)=>{(!this.alertDialog||this.alertDialog&&!this.alertDialog.isOpen)&&await b.AgentUtils.getAgentService().then((async i=>{let a=new g.JobData(e,t,i);this.alertDialog=new h.AlertDialog(e,a,o,!1)})),this.alertDialog.isOpen||(this.alertDialog.dialogName?await this.alertDialog.openDialog(this.alertDialog.dialogName):await this.alertDialog.openDialog())})),n.commands.registerCommand("agent.openOperatorDialog",(async(e,t)=>{(!this.operatorDialog||this.operatorDialog&&!this.operatorDialog.isOpen)&&(this.operatorDialog=new c.OperatorDialog(e,t)),this.operatorDialog.isOpen||(this.operatorDialog.dialogName?await this.operatorDialog.openDialog(this.operatorDialog.dialogName):await this.operatorDialog.openDialog())})),n.commands.registerCommand("agent.reuploadTemplate",(async(e,t)=>{let o=a.nb.activeNotebookEditor,i=this.notebookTemplateMap.get(o.document.uri.toString()),l=(await n.workspace.openTextDocument(i.fileUri)).getText();await s.promises.writeFile(i.tempPath,l),b.AgentUtils.getAgentService().then((async e=>{(await e.updateNotebook(i.ownerUri,i.notebookInfo.name,i.notebookInfo,i.tempPath)).success?n.window.showInformationMessage(x(1,null)):n.window.showInformationMessage(x(2,null))}))})),n.commands.registerCommand("agent.openProxyDialog",(async(e,t,o)=>{(!this.proxyDialog||this.proxyDialog&&!this.proxyDialog.isOpen)&&(this.proxyDialog=new u.ProxyDialog(e,t,o)),this.proxyDialog.isOpen||(this.proxyDialog.dialogName?await this.proxyDialog.openDialog(this.proxyDialog.dialogName):await this.proxyDialog.openDialog()),this.proxyDialog.dialogName?await this.proxyDialog.openDialog(this.proxyDialog.dialogName):await this.proxyDialog.openDialog()})),n.commands.registerCommand("agent.openNotebookEditorFromJsonString",(async(e,t,o,i)=>{const h=r.join(l.tmpdir(),"mssql_notebooks",e+".ipynb");await(0,b.exists)(r.join(l.tmpdir(),"mssql_notebooks"))||await s.promises.mkdir(r.join(l.tmpdir(),"mssql_notebooks")),await(0,b.exists)(h)&&await s.promises.unlink(h);try{await s.promises.writeFile(h,t);let e=n.Uri.parse(`untitled:${r.basename(h)}`);o&&(this.notebookTemplateMap.set(e.toString(),{notebookInfo:o,fileUri:e,ownerUri:i,tempPath:h}),n.commands.executeCommand("setContext","agent:trackedTemplate",!0)),await a.nb.showNotebookDocument(e,{initialContent:t,initialDirtyState:!1}),n.commands.executeCommand("setContext","agent:trackedTemplate",!1)}catch(e){n.window.showErrorMessage(e)}})),n.commands.registerCommand("agent.openNotebookDialog",(async(e,t)=>{if(!e||e instanceof n.Uri){let t;if(e)t=e.fsPath;else{if(a.nb.activeNotebookEditor.document.isDirty||a.nb.activeNotebookEditor.document.isUntitled)return void n.window.showErrorMessage(x(3,null),{modal:!0});t=a.nb.activeNotebookEditor.document.fileName}let o=await this.getConnectionFromUser();e=await a.connection.getUriForConnection(o.connectionId),this.notebookDialog=new w.NotebookDialog(e,{filePath:t,connection:o}),this.notebookDialog.isOpen||(this.notebookDialog.dialogName?await this.notebookDialog.openDialog(this.notebookDialog.dialogName):await this.notebookDialog.openDialog())}else(!this.notebookDialog||this.notebookDialog&&!this.notebookDialog.isOpen)&&(this.notebookDialog=new w.NotebookDialog(e,{notebookInfo:t})),this.notebookDialog.isOpen||(this.notebookDialog.dialogName?await this.notebookDialog.openDialog(this.notebookDialog.dialogName):await this.notebookDialog.openDialog())}))}async getConnectionFromUser(){let e=null,t=await a.connection.getActiveConnections();if(t&&0!==t.length){let o=[],i=[];for(let e=0;e<t.length;e++){let a=t[e].options.server+" ("+t[e].options.user+")";o.push(t[e]),i.push(a)}i.push(x(4,null));let s=await n.window.showQuickPick(i,{placeHolder:x(5,null)});-1!==i.indexOf(s)?e=s===x(6,null)?await a.connection.openConnectionDialog():t[i.indexOf(s)]:n.window.showErrorMessage(x(7,null),{modal:!0})}else e=await a.connection.openConnectionDialog();return e}deactivate(){}}},331:e=>{e.exports=require("azdata")},747:e=>{e.exports=require("fs")},87:e=>{e.exports=require("os")},622:e=>{e.exports=require("path")},549:e=>{e.exports=require("vscode")}},t={};function o(i){var a=t[i];if(void 0!==a)return a.exports;var n=t[i]={exports:{}};return e[i](n,n.exports,o),n.exports}var i={};(()=>{var e=i;Object.defineProperty(e,"__esModule",{value:!0}),e.deactivate=e.activate=void 0;const t=o(167);let a;e.activate=function(e){a=new t.MainController(e),a.activate()},e.deactivate=function(){a&&a.deactivate()}})();var a=exports;for(var n in i)a[n]=i[n];i.__esModule&&Object.defineProperty(a,"__esModule",{value:!0})})();
//# sourceMappingURL=https://sqlopsbuilds.blob.core.windows.net/sourcemaps/9fdb2161d49b4d4ab6798809faa042a898ca2eae/extensions/agent/dist/main.js.map